<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SECT - Security Intelligence for Everyone. Enterprise-grade security analysis simplified for everyday protection.">
    <meta name="theme-color" content="#0a1628">
    
    <title>SECT - Security Intelligence Platform</title>
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tesseract.js/4.1.1/tesseract.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js"></script>
    
    <!-- Threat Intelligence Module -->
    <script src="threat-intelligence.js"></script>
    <script src="ai-analyzer.js"></script>
    <script src="real-translation-service.js"></script>
    <script src="real-threat-feed.js"></script>
    <script src="real-api-integration.js"></script>
    <script src="local-threat-analysis.js"></script>
    <script src="translation-service.js"></script>
    <script src="link-safety-module.js"></script>
    <script src="sender-verification-module.js"></script>
    <script src="phone-verification-module.js"></script>
    <script src="enhanced-threat-intelligence.js"></script>
    <script src="real-knowledge-base.js"></script>
    <script src="cybersecurity-knowledge-base.js"></script>
    <script src="adaptive-learning-system.js"></script>
    <script src="behavioral-analysis-engine.js"></script>
    <script src="mini-ai-engine.js"></script>
    <script src="advanced-ai-engine.js"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <style>
        /**
         * SECT AMADI Design System
         * Advanced Monitoring and Detection Intelligence
         * Version: 3.0.0
         * 
         * Design Philosophy: Human-centered security intelligence
         * that combines enterprise-grade analysis with accessibility
         */
        
        :root {
            /* Brand Colors - High contrast for visibility */
            --sect-primary: #1e3a8a;        /* Deep blue */
            --sect-primary-dark: #0f172a;   /* Navy for dark backgrounds */
            --sect-primary-light: #3b82f6;  /* Bright blue for accents */
            --sect-primary-glow: #60a5fa;   /* Glowing blue */
            
            /* Light Theme */
            --bg-primary-light: #ffffff;
            --bg-secondary-light: #f8fafc;
            --bg-surface-light: #ffffff;
            --text-primary-light: #0f172a;
            --text-secondary-light: #475569;
            --text-tertiary-light: #94a3b8;
            --border-light: #e2e8f0;
            
            /* Dark Theme */
            --bg-primary-dark: #0a1628;
            --bg-secondary-dark: #0f1e36;
            --bg-surface-dark: #162544;
            --text-primary-dark: #f8fafc;
            --text-secondary-dark: #cbd5e1;
            --text-tertiary-dark: #94a3b8;
            --border-dark: rgba(148, 163, 184, 0.2);
            
            /* Security Status Colors */
            --status-safe: #10b981;
            --status-safe-bg: rgba(16, 185, 129, 0.1);
            --status-warning: #f59e0b;
            --status-warning-bg: rgba(245, 158, 11, 0.1);
            --status-danger: #ef4444;
            --status-danger-bg: rgba(239, 68, 68, 0.1);
            --status-critical: #dc2626;
            --status-critical-bg: rgba(220, 38, 38, 0.1);
            
            /* Visualization Colors */
            --viz-1: #3b82f6;
            --viz-2: #8b5cf6;
            --viz-3: #ec4899;
            --viz-4: #f59e0b;
            --viz-5: #10b981;
            
            /* Typography */
            --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            --font-mono: 'JetBrains Mono', 'Consolas', monospace;
            
            /* Shadows */
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.07);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.1);
            
            /* Animation */
            --ease-smooth: cubic-bezier(0.4, 0, 0.2, 1);
            --ease-spring: cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        /* Light theme (default) */
        body {
            --bg-primary: var(--bg-primary-light);
            --bg-secondary: var(--bg-secondary-light);
            --bg-surface: var(--bg-surface-light);
            --text-primary: var(--text-primary-light);
            --text-secondary: var(--text-secondary-light);
            --text-tertiary: var(--text-tertiary-light);
            --border-color: var(--border-light);
            --logo-color: var(--sect-primary);
        }
        
        /* Dark theme */
        body.dark-theme {
            --bg-primary: var(--bg-primary-dark);
            --bg-secondary: var(--bg-secondary-dark);
            --bg-surface: var(--bg-surface-dark);
            --text-primary: var(--text-primary-dark);
            --text-secondary: var(--text-secondary-dark);
            --text-tertiary: var(--text-tertiary-dark);
            --border-color: var(--border-dark);
            --logo-color: var(--sect-primary-glow);
            
            /* Dark theme shadows */
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.3);
            --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.3);
        }
        
        /* Reset */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        html {
            font-size: 16px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        body {
            font-family: var(--font-sans);
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: all 0.3s var(--ease-smooth);
        }
        
        /* Container */
        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }
        
        /* Header */
        .header {
            background: var(--bg-surface);
            border-bottom: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(8px);
            background: rgba(var(--bg-surface), 0.8);
        }
        
        .header-inner {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 0;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        /* Logo with proper dark mode contrast */
        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
            gap: 0.5rem;
            transition: transform 0.2s var(--ease-smooth);
        }
        
        .logo:hover {
            transform: translateY(-1px);
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--logo-color), var(--sect-primary-light));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 20px;
            color: white;
            box-shadow: var(--shadow-md);
        }
        
        .logo-text {
            font-size: 28px;
            font-weight: 700;
            color: var(--logo-color);
            letter-spacing: -0.02em;
        }
        
        .logo-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 500;
            margin-top: -4px;
        }
        
        /* Header controls */
        .header-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        /* Status indicator */
        .status-bar {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--bg-secondary);
            border-radius: 9999px;
            border: 1px solid var(--border-color);
            font-size: 14px;
            font-weight: 500;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            background: var(--status-safe);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(0.9); }
        }
        
        /* Language switcher */
        .lang-switcher {
            display: flex;
            background: var(--bg-secondary);
            border-radius: 9999px;
            padding: 4px;
            position: relative;
            border: 1px solid var(--border-color);
        }
        
        .lang-option {
            padding: 0.5rem 1rem;
            border: none;
            background: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: color 0.2s;
            position: relative;
            z-index: 2;
        }
        
        .lang-option.active {
            color: white;
        }
        
        .lang-slider {
            position: absolute;
            top: 4px;
            left: 4px;
            height: calc(100% - 8px);
            background: var(--sect-primary);
            border-radius: 9999px;
            transition: all 0.3s var(--ease-smooth);
            z-index: 1;
        }
        
        /* Theme toggle - moved out of header */
        .theme-toggle-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 100;
        }
        
        .theme-toggle {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: 1px solid var(--border-color);
            background: var(--bg-surface);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            color: var(--text-secondary);
            box-shadow: var(--shadow-lg);
        }
        
        .theme-toggle:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-xl);
        }
        
        /* Main content */
        .main {
            min-height: calc(100vh - 80px);
            padding: 3rem 0;
        }
        
        /* Hero section */
        .hero {
            text-align: center;
            margin-bottom: 4rem;
        }
        
        .hero-title {
            font-size: clamp(2rem, 4vw, 3rem);
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--sect-primary-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hero-subtitle {
            font-size: 1.125rem;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto 1rem;
        }
        
        .hero-tagline {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
            letter-spacing: 0.05em;
        }
        
        /* Privacy notice - properly centered */
        .privacy-notice {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            padding: 1.5rem;
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin: 0 auto 3rem;
            max-width: 800px;
            box-shadow: var(--shadow-sm);
        }
        
        .privacy-icon {
            width: 24px;
            height: 24px;
            color: var(--sect-primary);
            flex-shrink: 0;
        }
        
        /* Dashboard Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }
        
        .stat-card {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            position: relative;
            overflow: hidden;
            transition: all 0.3s var(--ease-smooth);
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--viz-1), var(--viz-2));
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s var(--ease-smooth);
        }
        
        .stat-card:hover::before {
            transform: scaleX(1);
        }
        
        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }
        
        .stat-title {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .stat-icon {
            width: 24px;
            height: 24px;
            color: var(--sect-primary-light);
        }
        
        .stat-value {
            font-size: 2.25rem;
            font-weight: 700;
            color: var(--text-primary);
            line-height: 1;
            margin-bottom: 0.5rem;
        }
        
        .stat-change {
            font-size: 0.875rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        .stat-change.positive {
            color: var(--status-safe);
        }
        
        .stat-change.negative {
            color: var(--status-danger);
        }
        
        .stat-chart {
            height: 60px;
            margin-top: 1rem;
        }
        
        /* Analysis Panel */
        .analysis-panel {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 3rem;
            box-shadow: var(--shadow-md);
        }
        
        .panel-header {
            margin-bottom: 2rem;
        }
        
        .panel-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .panel-description {
            color: var(--text-secondary);
        }
        
        /* Input groups */
        .input-grid {
            display: grid;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .input-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
        }
        
        .input-field {
            width: 100%;
            padding: 0.75rem 1rem;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-family: var(--font-sans);
            font-size: 1rem;
            color: var(--text-primary);
            transition: all 0.2s;
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--sect-primary-light);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .input-field::placeholder {
            color: var(--text-tertiary);
        }
        
        .textarea-field {
            min-height: 150px;
            resize: vertical;
            font-family: var(--font-mono);
            font-size: 0.875rem;
        }
        
        /* File upload */
        .file-upload {
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            background: var(--bg-secondary);
            position: relative;
            overflow: hidden;
        }
        
        .file-upload:hover {
            border-color: var(--sect-primary-light);
            background: var(--bg-surface);
        }
        
        .file-upload.drag-over {
            border-color: var(--status-safe);
            background: var(--status-safe-bg);
        }
        
        .upload-icon {
            width: 48px;
            height: 48px;
            color: var(--sect-primary-light);
            margin: 0 auto 1rem;
        }
        
        /* Analyze button */
        .analyze-btn {
            width: 100%;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, var(--sect-primary), var(--sect-primary-light));
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
        }
        
        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .analyze-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .analyze-btn:active::after {
            width: 300px;
            height: 300px;
        }
        
        /* Results section */
        .results-section {
            display: none;
            animation: fadeInUp 0.5s var(--ease-smooth);
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Threat visualization */
        .threat-viz {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
            box-shadow: var(--shadow-md);
        }
        
        .threat-meter {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 0 auto 2rem;
        }
        
        .threat-circle {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }
        
        .threat-bg {
            fill: none;
            stroke: var(--bg-secondary);
            stroke-width: 20;
        }
        
        .threat-progress {
            fill: none;
            stroke-width: 20;
            stroke-linecap: round;
            transition: all 1s var(--ease-smooth);
        }
        
        .threat-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }
        
        .threat-score {
            font-size: 3rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .threat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        /* Threat level badge */
        .threat-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1.5rem;
            border-radius: 9999px;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.875rem;
            letter-spacing: 0.05em;
        }
        
        .threat-safe {
            background: var(--status-safe-bg);
            color: var(--status-safe);
            border: 1px solid var(--status-safe);
        }
        
        .threat-warning {
            background: var(--status-warning-bg);
            color: var(--status-warning);
            border: 1px solid var(--status-warning);
        }
        
        .threat-danger {
            background: var(--status-danger-bg);
            color: var(--status-danger);
            border: 1px solid var(--status-danger);
        }
        
        /* Analysis tabs */
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--border-color);
            overflow-x: auto;
        }
        
        .tab-btn {
            padding: 1rem 1.5rem;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
            white-space: nowrap;
        }
        
        .tab-btn:hover {
            color: var(--text-primary);
        }
        
        .tab-btn.active {
            color: var(--sect-primary);
        }
        
        .tab-btn::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--sect-primary);
            transform: scaleX(0);
            transition: transform 0.3s var(--ease-smooth);
        }
        
        .tab-btn.active::after {
            transform: scaleX(1);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.3s;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Insights grid */
        .insights-grid {
            display: grid;
            gap: 1.5rem;
        }
        
        .insight-card {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s;
        }
        
        .insight-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .insight-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .insight-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        .insight-icon.good {
            background: var(--status-safe-bg);
            color: var(--status-safe);
        }
        
        .insight-icon.bad {
            background: var(--status-danger-bg);
            color: var(--status-danger);
        }
        
        /* Chart containers */
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 1rem;
        }
        
        .network-graph {
            width: 100%;
            min-height: 400px;
            background: var(--bg-secondary);
            border-radius: 12px;
            position: relative;
            padding: 2rem;
        }
        
        #comparisonChart {
            max-height: 350px;
        }
        
        /* Loading overlay */
        .loading-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .loading-overlay.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .loading-content {
            text-align: center;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 3px solid rgba(255, 255, 255, 0.2);
            border-top-color: var(--sect-primary-light);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1.5rem;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 1.25rem;
            color: white;
            margin-bottom: 0.5rem;
        }
        
        /* Real-time feed */
        .threat-feed {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.5rem;
            margin-top: 2rem;
            box-shadow: var(--shadow-md);
        }
        
        .feed-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }
        
        .feed-items {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .threat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .threat-item:hover {
            border-color: var(--sect-primary-light);
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }
        
        .threat-content {
            flex: 1;
        }
        
        .threat-title {
            color: var(--text-primary);
            font-size: 0.9rem;
            font-weight: 600;
            margin: 0 0 0.5rem 0;
            line-height: 1.3;
        }
        
        .threat-description {
            color: var(--text-secondary);
            font-size: 0.8rem;
            margin: 0 0 0.5rem 0;
            line-height: 1.4;
        }
        
        .threat-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.75rem;
            color: var(--text-tertiary);
        }
        
        .threat-action {
            margin-left: 1rem;
        }
        
        .read-more {
            color: var(--sect-primary);
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .feed-footer {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }
        
        .refresh-btn, .view-all-btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
        }
        
        .refresh-btn:hover, .view-all-btn:hover {
            background: var(--sect-primary);
            color: white;
            border-color: var(--sect-primary);
        }
        
        .last-update {
            color: var(--text-tertiary);
            font-size: 0.75rem;
        }
        
        /* Threat Modal */
        .threat-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 2rem;
        }
        
        .threat-modal-content {
            background: var(--bg-surface);
            border-radius: 12px;
            max-width: 800px;
            width: 100%;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: var(--shadow-xl);
        }
        
        .threat-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .threat-modal-header h2 {
            color: var(--text-primary);
            margin: 0;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 4px;
            transition: background 0.2s;
        }
        
        .close-btn:hover {
            background: var(--bg-secondary);
        }
        
        .threat-modal-body {
            padding: 1.5rem;
            max-height: calc(80vh - 120px);
            overflow-y: auto;
        }
        
        .threat-search input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-primary);
            color: var(--text-primary);
            margin-bottom: 1rem;
        }
        
        .modal-threat-item {
            padding: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .modal-threat-item:hover {
            border-color: var(--sect-primary-light);
            background: var(--bg-secondary);
        }
        
        .modal-threat-item h4 {
            color: var(--text-primary);
            margin: 0 0 0.5rem 0;
            font-size: 0.9rem;
        }
        
        .modal-threat-item p {
            color: var(--text-secondary);
            margin: 0 0 0.5rem 0;
            font-size: 0.8rem;
        }
        
        .modal-threat-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.75rem;
            color: var(--text-tertiary);
        }
        }
        
        .feed-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .feed-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }
        
        .feed-items {
            display: grid;
            gap: 0.75rem;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .feed-item {
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 8px;
            border-left: 3px solid;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .feed-item:hover {
            background: var(--bg-primary);
            transform: translateX(4px);
        }
        
        .feed-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .feed-time {
            font-size: 0.75rem;
            color: var(--text-tertiary);
        }
        
        .feed-source {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            background: var(--bg-primary);
            border-radius: 9999px;
            color: var(--text-secondary);
        }
        
        .feed-item-content {
            font-size: 0.875rem;
            line-height: 1.4;
        }
        
        .feed-item-details {
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid var(--border-color);
            font-size: 0.8125rem;
            color: var(--text-secondary);
        }
        
        .feed-item-details p {
            margin-bottom: 0.5rem;
        }
        
        .feed-learn-more {
            color: var(--sect-primary-light);
            text-decoration: none;
            font-weight: 500;
        }
        
        .feed-learn-more:hover {
            text-decoration: underline;
        }
        
        .feed-item.critical {
            border-color: var(--status-critical);
        }
        
        .feed-item.warning {
            border-color: var(--status-warning);
        }
        
        .feed-item.info {
            border-color: var(--sect-primary-light);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header-inner {
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .threat-meter {
                width: 150px;
                height: 150px;
            }
            
            .threat-score {
                font-size: 2.5rem;
            }
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--text-tertiary);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }
        
        /* Footer */
        .footer {
            background: var(--bg-surface);
            border-top: 1px solid var(--border-color);
            padding: 2rem 0;
            margin-top: 4rem;
        }
        
        .footer-content {
            text-align: center;
        }
        
        .footer-tagline {
            font-size: 1.125rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .footer-copyright {
            font-size: 0.875rem;
            color: var(--text-tertiary);
            margin-bottom: 1.5rem;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
        }
        
        .footer-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.95rem;
            transition: color 0.2s;
        }
        
        .footer-link:hover {
            color: var(--sect-primary-light);
        }
        
        /* Link Safety Module Styles */
        .link-safety-warning {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            box-shadow: var(--shadow-md);
        }
        
        .link-safety-warning.low-risk {
            border-left: 4px solid var(--status-safe);
        }
        
        .link-safety-warning.medium-risk {
            border-left: 4px solid var(--status-warning);
        }
        
        .link-safety-warning.high-risk {
            border-left: 4px solid var(--status-danger);
        }
        
        .link-safety-warning h3 {
            color: var(--text-primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .warning-message {
            color: var(--status-warning);
            font-weight: 500;
            margin-bottom: 1rem;
        }
        
        .link-count {
            background: var(--bg-secondary);
            padding: 0.75rem 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }
        
        .safety-instructions {
            margin-bottom: 1.5rem;
        }
        
        .safety-instructions h4 {
            color: var(--text-primary);
            margin-bottom: 0.75rem;
        }
        
        .safety-instructions ol {
            margin: 0;
            padding-left: 1.5rem;
            color: var(--text-secondary);
        }
        
        .safety-instructions li {
            margin-bottom: 0.5rem;
        }
        
        .link-analysis {
            margin-bottom: 1.5rem;
        }
        
        .link-item {
            background: var(--bg-secondary);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 0.75rem;
        }
        
        .link-url {
            font-family: var(--font-mono);
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            word-break: break-all;
        }
        
        .link-risks {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .risk-item {
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            font-size: 0.85rem;
        }
        
        .risk-item.low {
            background: var(--status-safe-bg);
            color: var(--status-safe);
        }
        
        .risk-item.medium {
            background: var(--status-warning-bg);
            color: var(--status-warning);
        }
        
        .risk-item.high {
            background: var(--status-danger-bg);
            color: var(--status-danger);
        }
        
        .no-risks {
            color: var(--status-safe);
            font-size: 0.9rem;
        }
        
        .additional-tips {
            background: var(--bg-secondary);
            padding: 1rem;
            border-radius: 8px;
        }
        
        .additional-tips h4 {
            color: var(--text-primary);
            margin-bottom: 0.75rem;
        }
        
        .additional-tips ul {
            margin: 0;
            padding-left: 1.5rem;
            color: var(--text-secondary);
        }
        
        .additional-tips li {
            margin-bottom: 0.5rem;
        }
        
        /* Sender Verification Module Styles */
        .sender-verification-report {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            box-shadow: var(--shadow-md);
        }
        
        .verification-summary {
            background: var(--bg-secondary);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }
        
        .risk-level {
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }
        
        .low-risk {
            color: var(--status-safe);
        }
        
        .medium-risk {
            color: var(--status-warning);
        }
        
        .high-risk {
            color: var(--status-danger);
        }
        
        .sender-info div {
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }
        
        .trusted-domain {
            color: var(--status-safe);
            padding: 0.75rem;
            background: var(--status-safe-bg);
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        
        .spoofing-warnings {
            margin-bottom: 1.5rem;
        }
        
        .spoofing-warnings h4 {
            color: var(--status-danger);
            margin-bottom: 0.75rem;
        }
        
        .spoofing-warnings ul {
            margin: 0;
            padding-left: 1.5rem;
        }
        
        .low-severity {
            color: var(--status-safe);
        }
        
        .medium-severity {
            color: var(--status-warning);
        }
        
        .high-severity {
            color: var(--status-danger);
        }
        
        .phone-verification {
            background: var(--bg-secondary);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        
        .phone-warnings {
            margin-top: 0.5rem;
            color: var(--status-warning);
        }
        
        .recommendations {
            background: var(--bg-secondary);
            padding: 1rem;
            border-radius: 8px;
        }
        
        .recommendations h4 {
            color: var(--text-primary);
            margin-bottom: 0.75rem;
        }
        
        .recommendations ul {
            margin: 0;
            padding-left: 1.5rem;
            color: var(--text-secondary);
        }
        
        .recommendations li {
            margin-bottom: 0.5rem;
        }
        
        /* Phone Verification Module Styles */
        .phone-safety-warning {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            box-shadow: var(--shadow-md);
        }
        
        .phone-safety-warning.low-risk {
            border-left: 4px solid var(--status-safe);
        }
        
        .phone-safety-warning.medium-risk {
            border-left: 4px solid var(--status-warning);
        }
        
        .phone-safety-warning.high-risk {
            border-left: 4px solid var(--status-danger);
        }
        
        .phone-safety-warning.critical-risk {
            border-left: 4px solid var(--status-critical);
        }
        
        .phone-safety-tips {
            background: var(--bg-secondary);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }
        
        .phone-safety-tips h4 {
            color: var(--text-primary);
            margin-bottom: 0.75rem;
        }
        
        .phone-safety-tips ul {
            margin: 0;
            padding-left: 1.5rem;
            color: var(--text-secondary);
        }
        
        .phone-item {
            background: var(--bg-secondary);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 0.75rem;
        }
        
        .phone-number {
            font-family: var(--font-mono);
            font-size: 1.1rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .phone-risks {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .phone-verification-tip {
            background: var(--bg-secondary);
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
        }
        
        .phone-verification-tip h4 {
            color: var(--text-primary);
            margin-bottom: 0.75rem;
        }
        
        .phone-verification-tip ol {
            margin: 0;
            padding-left: 1.5rem;
            color: var(--text-secondary);
        }
        
        .phone-verification-tip li {
            margin-bottom: 0.5rem;
        }
        
        /* Chart Container Dark Mode Fixes */
        body.dark .tab-content canvas {
            background: var(--bg-surface);
            border-radius: 8px;
            padding: 10px;
        }
        
        /* Ensure chart visibility in dark mode */
        body.dark #networkGraph,
        body.dark #timelineChart {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 8px;
        }
        
        /* Fix for D3 network graph text in dark mode */
        body.dark .node text {
            fill: var(--text-primary) !important;
        }
        
        body.dark .link {
            stroke: var(--text-tertiary) !important;
        }
        
        /* Additional contrast for chart elements */
        body.dark .chart-container {
            background: var(--bg-surface);
            padding: 1rem;
            border-radius: 8px;
        }
        
        /* Knowledge Base Styles */
        .knowledge-base {
            max-width: 100%;
            margin: 0 auto;
        }
        
        .kb-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .kb-header h2 {
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .kb-header p {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }
        
        .kb-search {
            display: flex;
            gap: 0.5rem;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .kb-search input {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 0.875rem;
        }
        
        .kb-search button {
            padding: 0.75rem 1.5rem;
            background: var(--sect-primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            transition: background 0.2s;
        }
        
        .kb-search button:hover {
            background: var(--sect-primary-dark);
        }
        
        .kb-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 2rem;
            margin-top: 2rem;
        }
        
        @media (max-width: 768px) {
            .kb-content {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }
        }
        
        .kb-search {
            display: flex;
            gap: 0.5rem;
            max-width: 600px;
            margin: 1rem auto;
        }
        
        .kb-search input {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-surface);
            color: var(--text-primary);
            font-size: 1rem;
        }
        
        .kb-search button {
            padding: 0.75rem 1.5rem;
            background: var(--sect-primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.2s;
        }
        
        .kb-search button:hover {
            background: var(--sect-primary-light);
        }
        
        .kb-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .kb-categories {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .kb-category {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .kb-category:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            border-color: var(--sect-primary-light);
        }
        
        .kb-category-icon {
            font-size: 2rem;
            flex-shrink: 0;
        }
        
        .kb-category-info h3 {
            color: var(--text-primary);
            margin: 0 0 0.25rem 0;
            font-size: 1rem;
        }
        
        .kb-category-info p {
            color: var(--text-secondary);
            margin: 0 0 0.5rem 0;
            font-size: 0.875rem;
            line-height: 1.4;
        }
        
        .kb-article-count {
            color: var(--text-tertiary);
            font-size: 0.75rem;
        }
        
        .kb-articles, .kb-search-results {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            min-height: 400px;
        }
        
        .kb-welcome h3 {
            color: var(--text-primary);
            margin-bottom: 1rem;
        }
        
        .kb-quick-topics {
            margin-top: 2rem;
        }
        
        .kb-quick-topics h4 {
            color: var(--text-primary);
            margin-bottom: 1rem;
        }
        
        .kb-topic-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .kb-tag {
            padding: 0.5rem 1rem;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border-radius: 20px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid var(--border-color);
        }
        
        .kb-tag:hover {
            background: var(--sect-primary);
            color: white;
        }
        
        .kb-article-preview {
            padding: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .kb-article-preview:hover {
            border-color: var(--sect-primary-light);
            transform: translateY(-1px);
        }
        
        .kb-article-preview h4 {
            color: var(--text-primary);
            margin: 0 0 0.5rem 0;
        }
        
        .kb-article-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.25rem;
        }
        
        .kb-article-tags .kb-tag {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
        }
        
        .kb-article-full {
            max-width: 100%;
        }
        
        .kb-article-header {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .kb-back-btn {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            margin-bottom: 1rem;
            transition: background 0.2s;
        }
        
        .kb-back-btn:hover {
            background: var(--sect-primary);
            color: white;
        }
        
        .kb-article-content {
            color: var(--text-primary);
            line-height: 1.6;
            max-width: none;
        }
        
        .kb-article-content h3 {
            color: var(--text-primary);
            margin: 2rem 0 1rem 0;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--sect-primary-light);
        }
        
        .kb-article-content h4 {
            color: var(--text-primary);
            margin: 1.5rem 0 0.75rem 0;
        }
        
        .kb-article-content h5 {
            color: var(--text-primary);
            margin: 1rem 0 0.5rem 0;
        }
        
        .kb-article-content ul, .kb-article-content ol {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }
        
        .kb-article-content li {
            margin: 0.5rem 0;
            color: var(--text-secondary);
        }
        
        .kb-article-content strong {
            color: var(--text-primary);
        }
        
        .kb-search-results h3 {
            color: var(--text-primary);
            margin-bottom: 1rem;
        }
        
        .kb-search-result {
            padding: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .kb-search-result:hover {
            border-color: var(--sect-primary-light);
            transform: translateY(-1px);
        }
        
        .kb-search-result h4 {
            color: var(--text-primary);
            margin: 0 0 0.5rem 0;
        }
        
        .kb-search-result p {
            color: var(--text-secondary);
            margin: 0 0 0.5rem 0;
            font-size: 0.875rem;
        }
        
        .kb-clear-search {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            margin-left: 1rem;
        }
        
        .kb-clear-search:hover {
            background: var(--sect-primary);
            color: white;
        }
        
        .kb-no-results {
            text-align: center;
            padding: 2rem;
        }
        
        .kb-no-results h3 {
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .kb-no-results p {
            color: var(--text-secondary);
        }
        
        /* Behavioral Analysis Styles */
        .behavior-level {
            text-align: center;
        }
        
        .behavior-low {
            background: var(--status-safe-bg);
            color: var(--status-safe);
        }
        
        .behavior-medium {
            background: var(--status-warning-bg);
            color: var(--status-warning);
        }
        
        .behavior-high {
            background: var(--status-danger-bg);
            color: var(--status-danger);
        }
        
        @media (max-width: 768px) {
            .kb-content {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .kb-search {
                flex-direction: column;
            }
            
            .kb-topic-tags {
                justify-content: center;
            }
            
            .feedback-buttons {
                flex-direction: column;
            }
            
            .feedback-btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Loading overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text" id="loadingText">Analyzing threat intelligence...</div>
            <div class="loading-progress" id="loadingProgress"></div>
        </div>
    </div>
    
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-inner">
                <a href="#" class="logo">
                    <div class="logo-icon">S</div>
                    <div>
                        <div class="logo-text">SECT</div>
                        <div class="logo-subtitle">Security for the Everyday Person</div>
                    </div>
                </a>
                
                <div class="header-controls">
                    <div class="status-bar">
                        <div class="status-dot"></div>
                        <span data-i18n="status">Real-time Protection Active</span>
                    </div>
                    
                    <div class="lang-switcher">
                        <button class="lang-option active" data-lang="en" onclick="setLanguage('en')">EN</button>
                        <button class="lang-option" data-lang="es" onclick="setLanguage('es')">ES</button>
                        <div class="lang-slider" id="langSlider"></div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Main content -->
    <main class="main">
        <div class="container">
            <!-- Hero section -->
            <section class="hero">
                <h1 class="hero-title" data-i18n="hero.title">Security Intelligence for Everyone</h1>
                <p class="hero-subtitle" data-i18n="hero.subtitle">
                    Enterprise-grade threat detection tool, simplified for the everyday person
                </p>
                <p class="hero-tagline" data-i18n="hero.tagline">
                    The first of its kind - bringing enterprise security to everyone
                </p>
            </section>
            
            <!-- Privacy notice -->
            <div class="privacy-notice">
                <svg class="privacy-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/>
                </svg>
                <p data-i18n="privacy">Your data never leaves your device. SECT analyzes everything locally for maximum privacy.</p>
            </div>
            
            <!-- Dashboard Stats -->
            <section class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <h3 class="stat-title" data-i18n="stats.threats">Active Threats</h3>
                        <svg class="stat-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-9-5z"/>
                        </svg>
                    </div>
                    <div class="stat-value" id="threatCount">0</div>
                    <div class="stat-change positive">
                        <span>↓ 12%</span>
                        <span data-i18n="stats.vsLastWeek">vs last week</span>
                    </div>
                    <div class="stat-chart">
                        <canvas id="threatChart"></canvas>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h3 class="stat-title" data-i18n="stats.analyzed">Emails Analyzed</h3>
                        <svg class="stat-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                        </svg>
                    </div>
                    <div class="stat-value" id="emailCount">0</div>
                    <div class="stat-change positive">
                        <span>↑ 8%</span>
                        <span data-i18n="stats.growth">growth</span>
                    </div>
                    <div class="stat-chart">
                        <canvas id="emailChart"></canvas>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <h3 class="stat-title" data-i18n="stats.accuracy">AI Accuracy</h3>
                        <svg class="stat-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"/>
                        </svg>
                    </div>
                    <div class="stat-value">99.7%</div>
                    <div class="stat-change">
                        <span data-i18n="stats.detection">Detection Rate</span>
                    </div>
                    <div class="stat-chart">
                        <canvas id="accuracyChart"></canvas>
                    </div>
                </div>
            </section>
            
            <!-- Analysis Panel -->
            <section class="analysis-panel">
                <div class="panel-header">
                    <h2 class="panel-title" data-i18n="analysis.title">Analyze Email</h2>
                    <p class="panel-description" data-i18n="analysis.desc">
                        Paste an email or upload a file for comprehensive security analysis
                    </p>
                </div>
                
                <div class="input-grid">
                    <div class="input-group">
                        <label class="input-label" for="sender" data-i18n="input.sender">Sender Email (optional)</label>
                        <input type="email" id="sender" class="input-field" data-i18n-placeholder="input.senderPlaceholder">
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label" for="subject" data-i18n="input.subject">Subject Line (optional)</label>
                        <input type="text" id="subject" class="input-field" data-i18n-placeholder="input.subjectPlaceholder">
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label" for="body" data-i18n="input.body">Email Content</label>
                        <textarea id="body" class="input-field textarea-field" data-i18n-placeholder="input.bodyPlaceholder"></textarea>
                    </div>
                </div>
                
                <div class="file-upload" id="fileUpload">
                    <input type="file" id="fileInput" accept=".txt,.eml,.msg,.pdf,image/*,audio/*" style="display: none;">
                    <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    <p class="upload-text" data-i18n="upload.text">Drop files here or click to upload</p>
                    <p class="upload-hint" data-i18n="upload.hint">Supports emails, PDFs, images, and audio</p>
                </div>
                
                <button class="analyze-btn" onclick="analyzeEmail()">
                    <span data-i18n="button.analyze">Analyze with SECT Intelligence</span>
                </button>
            </section>
            
            <!-- Results section -->
            <section class="results-section" id="results">
                <!-- Threat visualization -->
                <div class="threat-viz">
                    <div class="threat-meter">
                        <svg class="threat-circle" viewBox="0 0 200 200">
                            <circle cx="100" cy="100" r="80" class="threat-bg"></circle>
                            <circle 
                                cx="100" 
                                cy="100" 
                                r="80" 
                                class="threat-progress"
                                id="threatProgress"
                                stroke-dasharray="502"
                                stroke-dashoffset="502"
                            ></circle>
                        </svg>
                        <div class="threat-text">
                            <div class="threat-score" id="threatScore">0</div>
                            <div class="threat-label" data-i18n="threat.score">Threat Score</div>
                        </div>
                    </div>
                    
                    <div class="threat-badge threat-safe" id="threatBadge">
                        <span data-i18n="threat.safe">SAFE</span>
                    </div>
                </div>
                
                <!-- Analysis tabs -->
                <div class="tabs">
                    <button class="tab-btn active" onclick="switchTab('overview')" data-i18n="tabs.overview">Overview</button>
                    <button class="tab-btn" onclick="switchTab('details')" data-i18n="tabs.details">Detailed Analysis</button>
                    <button class="tab-btn" onclick="switchTab('network')" data-i18n="tabs.network">Network Graph</button>
                    <button class="tab-btn" onclick="switchTab('timeline')" data-i18n="tabs.timeline">Timeline</button>
                    <button class="tab-btn" onclick="switchTab('education')" data-i18n="tabs.education">Knowledge Base</button>
                </div>
                
                <!-- Tab content -->
                <div class="tab-content active" id="overviewTab">
                    <div class="insights-grid" id="insightsGrid"></div>
                </div>
                
                <div class="tab-content" id="detailsTab">
                    <div id="detailedAnalysis"></div>
                </div>
                
                <div class="tab-content" id="networkTab">
                    <div class="network-graph" id="networkGraph"></div>
                </div>
                
                <div class="tab-content" id="timelineTab">
                    <div class="chart-container">
                        <canvas id="timelineChart"></canvas>
                    </div>
                </div>
                
                <div class="tab-content" id="educationTab">
                    <div id="knowledgeBaseContainer">
                        <!-- Knowledge base will be dynamically loaded here -->
                    </div>
                </div>
            </section>
            
            <!-- Real-time threat feed -->
            <section class="threat-feed">
                <div class="feed-header">
                    <h3 class="feed-title" data-i18n="feed.title">Real-time Threat Intelligence</h3>
                    <div class="feed-status">
                        <div class="status-dot"></div>
                        <span data-i18n="feed.live">Live</span>
                    </div>
                </div>
                <div class="feed-items" id="threatFeed"></div>
            </section>
        </div>
    </main>
    
    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <p class="footer-tagline" data-i18n="footer.tagline">Security for the everyday person</p>
                <p class="footer-copyright">© <span id="copyrightYear">2025</span> Sect. All rights reserved.</p>
                <div class="footer-links">
                    <a href="#" class="footer-link" onclick="showModal('privacy')" data-i18n="footer.privacy">Privacy Policy</a>
                    <a href="#" class="footer-link" onclick="showModal('terms')" data-i18n="footer.terms">Terms of Service</a>
                    <a href="#" class="footer-link" onclick="showModal('about')" data-i18n="footer.about">About</a>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Theme toggle (outside header) -->
    <div class="theme-toggle-container">
        <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle theme">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" id="themeIcon">
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
        </button>
    </div>
    
    <script>
        /**
         * SECT - Security Intelligence Platform
         * Version: 3.0.0
         * 
         * A human-centered security intelligence platform that combines
         * enterprise-grade threat analysis with accessibility for everyday users.
         * 
         * @author SECT Intelligence Team
         * @license MIT
         */
        
        'use strict';
        
        // =====================================================
        // CONFIGURATION
        // =====================================================
        
        /**
         * Core configuration for SECT system
         * @namespace SectConfig
         */
        const SectConfig = {
            version: '3.0.0',
            
            /** Threat detection thresholds */
            thresholds: {
                safe: 30,
                warning: 60,
                danger: 80
            },
            
            /** Supported languages */
            languages: ['en', 'es'],
            
            /** Real-time threat intelligence endpoints */
            threatIntel: {
                phishingDB: 'https://api.sect.ai/v1/phishing',
                malwareDB: 'https://api.sect.ai/v1/malware',
                threatFeeds: 'https://api.sect.ai/v1/feeds'
            },
            
            /** Chart configuration */
            chartDefaults: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                }
            }
        };
        
        // =====================================================
        // INTERNATIONALIZATION
        // =====================================================
        
        /**
         * Internationalization module for multi-language support
         * @namespace I18n
         */
        const I18n = {
            currentLang: localStorage.getItem('sectLang') || 'en',
            
            translations: {
                en: {
                    // Status
                    'status': 'Real-time Protection Active',
                    
                    // Hero
                    'hero.title': 'Security Intelligence for Everyone',
                    'hero.subtitle': 'Enterprise-grade threat detection tool, simplified for the everyday person',
                    'hero.tagline': 'The first of its kind - bringing enterprise security to everyone',
                    
                    // Footer
                    'footer.tagline': 'Security for the everyday person',
                    'footer.privacy': 'Privacy Policy',
                    'footer.terms': 'Terms of Service',
                    'footer.about': 'About',
                    'footer.learn': 'Learn More',
                    
                    // Privacy
                    'privacy': 'Your data never leaves your device. SECT analyzes everything locally for maximum privacy.',
                    
                    // Stats
                    'stats.threats': 'Active Threats',
                    'stats.analyzed': 'Emails Analyzed',
                    'stats.accuracy': 'AI Accuracy',
                    'stats.vsLastWeek': 'vs last week',
                    'stats.growth': 'growth',
                    'stats.detection': 'Detection Rate',
                    
                    // Analysis
                    'analysis.title': 'Analyze Email',
                    'analysis.desc': 'Paste an email or upload a file for comprehensive security analysis',
                    
                    // Input
                    'input.sender': 'Sender Email (optional)',
                    'input.senderPlaceholder': 'sender@example.com',
                    'input.subject': 'Subject Line (optional)',
                    'input.subjectPlaceholder': 'Email subject',
                    'input.body': 'Email Content',
                    'input.bodyPlaceholder': 'Paste the email content here for analysis...',
                    
                    // Upload
                    'upload.text': 'Drop files here or click to upload',
                    'upload.hint': 'Supports emails, PDFs, images, and audio',
                    
                    // Button
                    'button.analyze': 'Analyze with SECT Intelligence',
                    
                    // Threat
                    'threat.score': 'Threat Score',
                    'threat.safe': 'SAFE',
                    'threat.warning': 'WARNING',
                    'threat.danger': 'DANGER',
                    
                    // Tabs
                    'tabs.overview': 'Overview',
                    'tabs.details': 'Detailed Analysis',
                    'tabs.network': 'Network Graph',
                    'tabs.timeline': 'Timeline',
                    'tabs.education': 'Knowledge Base',
                    
                    // Education
                    'education.legitimate': 'What Makes an Email Legitimate',
                    'education.phishing': 'Red Flags of Phishing',
                    'education.scoreExplanation': 'Understanding Threat Scores',
                    
                    // Feed
                    'feed.title': 'Real-time Threat Intelligence',
                    'feed.live': 'Live',
                    
                    // Loading
                    'loading.analyzing': 'Analyzing threat intelligence...',
                    'loading.searching': 'Searching global threat databases...',
                    'loading.ocr': 'Extracting text from image...',
                    
                    // Insights
                    'insight.urgency': 'Urgency Tactics Detected',
                    'insight.sender': 'Suspicious Sender',
                    'insight.links': 'Dangerous Links',
                    'insight.attachments': 'Risky Attachments',
                    'insight.grammar': 'Poor Grammar',
                    'insight.ai': 'AI Analysis',
                    'insight.ai.urgency': 'Email sentiment indicates aggressive urgency',
                    'insight.ai.writing': 'Writing style inconsistent with legitimate organizations',
                    'insight.ai.pattern': 'Pattern matches known phishing campaigns',
                    'insight.ai.sender': 'Unusual sender behavior detected',
                    'insight.ai.similar': 'Similar emails reported in phishing databases',
                    'insight.ai.domain': 'Domain flagged in recent security bulletins',
                    
                    // Feed translations
                    'feed.affectedRegions': 'Affected Regions',
                    'feed.recommendation': 'Recommendation',
                    'feed.learnMore': 'Learn More',
                    
                    // Chart translations
                    'chart.currentEmail': 'Current Email',
                    'chart.phishingAverage': 'Phishing Average',
                    'chart.legitimateAverage': 'Legitimate Average'
                },
                es: {
                    // Status
                    'status': 'Protección en Tiempo Real Activa',
                    
                    // Hero
                    'hero.title': 'Inteligencia de Seguridad para Todos',
                    'hero.subtitle': 'Herramienta de detección de amenazas de nivel empresarial, simplificada para la persona común',
                    'hero.tagline': 'El primero de su tipo - llevando seguridad empresarial a todos',
                    
                    // Footer
                    'footer.tagline': 'Seguridad para la persona común',
                    'footer.privacy': 'Política de Privacidad',
                    'footer.terms': 'Términos de Servicio',
                    'footer.about': 'Acerca de',
                    'footer.learn': 'Aprende Más',
                    
                    // Privacy
                    'privacy': 'Tus datos nunca abandonan tu dispositivo. SECT analiza todo localmente para máxima privacidad.',
                    
                    // Stats
                    'stats.threats': 'Amenazas Activas',
                    'stats.analyzed': 'Correos Analizados',
                    'stats.accuracy': 'Precisión IA',
                    'stats.vsLastWeek': 'vs semana pasada',
                    'stats.growth': 'crecimiento',
                    'stats.detection': 'Tasa de Detección',
                    
                    // Analysis
                    'analysis.title': 'Analizar Correo',
                    'analysis.desc': 'Pega un correo o sube un archivo para análisis de seguridad completo',
                    
                    // Input
                    'input.sender': 'Correo del Remitente (opcional)',
                    'input.senderPlaceholder': 'remitente@ejemplo.com',
                    'input.subject': 'Línea de Asunto (opcional)',
                    'input.subjectPlaceholder': 'Asunto del correo',
                    'input.body': 'Contenido del Correo',
                    'input.bodyPlaceholder': 'Pega el contenido del correo aquí para análisis...',
                    
                    // Upload
                    'upload.text': 'Suelta archivos aquí o haz clic para subir',
                    'upload.hint': 'Soporta correos, PDFs, imágenes y audio',
                    
                    // Button
                    'button.analyze': 'Analizar con Inteligencia SECT',
                    
                    // Threat
                    'threat.score': 'Puntuación de Amenaza',
                    'threat.safe': 'SEGURO',
                    'threat.warning': 'ADVERTENCIA',
                    'threat.danger': 'PELIGRO',
                    
                    // Tabs
                    'tabs.overview': 'Resumen',
                    'tabs.details': 'Análisis Detallado',
                    'tabs.network': 'Gráfico de Red',
                    'tabs.timeline': 'Línea de Tiempo',
                    'tabs.education': 'Base de Conocimientos',
                    
                    // Education
                    'education.legitimate': 'Qué Hace Legítimo a un Correo',
                    'education.phishing': 'Señales de Alerta de Phishing',
                    'education.scoreExplanation': 'Entendiendo las Puntuaciones de Amenaza',
                    
                    // Feed
                    'feed.title': 'Inteligencia de Amenazas en Tiempo Real',
                    'feed.live': 'En Vivo',
                    
                    // Loading
                    'loading.analyzing': 'Analizando inteligencia de amenazas...',
                    'loading.searching': 'Buscando en bases de datos globales de amenazas...',
                    'loading.ocr': 'Extrayendo texto de la imagen...',
                    
                    // Insights
                    'insight.urgency': 'Tácticas de Urgencia Detectadas',
                    'insight.sender': 'Remitente Sospechoso',
                    'insight.links': 'Enlaces Peligrosos',
                    'insight.attachments': 'Adjuntos Riesgosos',
                    'insight.grammar': 'Gramática Deficiente',
                    'insight.ai': 'Análisis IA',
                    'insight.ai.urgency': 'El sentimiento del correo indica urgencia agresiva',
                    'insight.ai.writing': 'Estilo de escritura inconsistente con organizaciones legítimas',
                    'insight.ai.pattern': 'El patrón coincide con campañas de phishing conocidas',
                    'insight.ai.sender': 'Comportamiento inusual del remitente detectado',
                    'insight.ai.similar': 'Correos similares reportados en bases de datos de phishing',
                    'insight.ai.domain': 'Dominio marcado en boletines de seguridad recientes',
                    
                    // Feed translations
                    'feed.affectedRegions': 'Regiones Afectadas',
                    'feed.recommendation': 'Recomendación',
                    'feed.learnMore': 'Aprender Más',
                    
                    // Chart translations
                    'chart.currentEmail': 'Correo Actual',
                    'chart.phishingAverage': 'Promedio de Phishing',
                    'chart.legitimateAverage': 'Promedio Legítimo'
                }
            },
            
            /**
             * Get translated text
             * @param {string} key - Translation key
             * @returns {string} Translated text
             */
            t(key) {
                return this.translations[this.currentLang][key] || key;
            },
            
            /**
             * Update all UI elements with translations
             */
            updateUI() {
                // Update text content
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    el.textContent = this.t(key);
                });
                
                // Update placeholders
                document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                    const key = el.getAttribute('data-i18n-placeholder');
                    el.placeholder = this.t(key);
                });
                
                // Update educational content if it exists
                const scoreExplanation = document.getElementById('scoreExplanation');
                if (scoreExplanation && window.educationalContent) {
                    const content = window.educationalContent[this.currentLang] || window.educationalContent.en;
                    scoreExplanation.innerHTML = `
                        <div style="margin-bottom: 1rem;">
                            <h4 style="color: var(--status-safe); margin-bottom: 0.5rem;">🔒 ${this.t('threat.safe')} (0-30)</h4>
                            <p style="color: var(--text-secondary); font-size: 0.875rem;">${content.scoreExplanation.safe}</p>
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <h4 style="color: var(--status-warning); margin-bottom: 0.5rem;">⚠️ ${this.t('threat.warning')} (31-60)</h4>
                            <p style="color: var(--text-secondary); font-size: 0.875rem;">${content.scoreExplanation.warning}</p>
                        </div>
                        <div>
                            <h4 style="color: var(--status-danger); margin-bottom: 0.5rem;">🚫 ${this.t('threat.danger')} (61-100)</h4>
                            <p style="color: var(--text-secondary); font-size: 0.875rem;">${content.scoreExplanation.danger}</p>
                        </div>
                    `;
                }
                
                // Update educational lists
                const updateList = (id, items) => {
                    const element = document.getElementById(id);
                    if (element && items) {
                        element.innerHTML = items.map(item => `<li>${item}</li>`).join('');
                    }
                };
                
                if (window.educationalContent) {
                    const content = window.educationalContent[this.currentLang] || window.educationalContent.en;
                    updateList('legitimatePoints', content.legitimate);
                    updateList('phishingPoints', content.phishing);
                }
            }
        };
        
        // =====================================================
        // THREAT DETECTION ENGINE
        // =====================================================
        
        /**
         * Advanced threat detection engine with AI capabilities
         * @namespace ThreatEngine
         * 
         * TO MAKE SECT STATE-OF-THE-ART FOR VULNERABLE POPULATIONS:
         * 
         * CRITICAL IMPROVEMENTS NEEDED:
         * 
         * 1. REAL THREAT INTELLIGENCE (Replace Simulated APIs):
         *    - VirusTotal API: Free 500 requests/day - Check URLs against 90+ engines
         *    - PhishTank API: Free access to 50,000+ verified phishing URLs
         *    - URLVoid: Free tier for URL reputation checking
         *    - Have I Been Pwned: Check if sender email was breached
         *    - Google Safe Browsing: Free API for malicious URL detection
         * 
         * 2. ACTUAL AI IMPLEMENTATION (Current is fake):
         *    - OpenAI API: $0.002 per 1K tokens for real content analysis
         *    - Local LLM: Use TensorFlow.js or ONNX for privacy
         *    - Sentiment Analysis: Detect emotional manipulation
         *    - Writing Style: Identify non-native speaker patterns
         * 
         * 3. ROMANCE SCAM SPECIFIC FEATURES:
         *    - Profile Photo Analysis: TinEye/Google reverse image API
         *    - Love Bombing Detection: Excessive affection patterns
         *    - Story Consistency: Track claims across conversations
         *    - Video Call Excuses: Red flag when avoiding video
         *    - Money Request Timing: Alert after relationship milestones
         * 
         * 4. ELDER-FOCUSED PROTECTION:
         *    - Larger UI with high contrast for visibility
         *    - Voice alerts for threats
         *    - Simplified threat explanations
         *    - Auto-forward suspicious emails to trusted contact
         *    - One-click report to authorities
         * 
         * 5. REAL-TIME PROTECTION:
         *    - Browser extension for Gmail/Outlook/Yahoo
         *    - WhatsApp Web integration
         *    - Facebook Messenger scanner
         *    - Dating app message analyzer (Tinder, Match, etc)
         *    - SMS/iMessage protection on desktop
         */
        const ThreatEngine = {
            /**
             * Multi-language threat patterns
             */
            patterns: {
                en: {
                    urgency: {
                        patterns: [
                            /urgent.*action/i,
                            /immediate.*attention/i,
                            /act.*now/i,
                            /expire.*soon/i,
                            /limited.*time/i,
                            /final.*notice/i,
                            /suspend.*within/i,
                            /24.*hours/i
                        ],
                        weight: 15,
                        category: 'Urgency Tactics'
                    },
                    financial: {
                        patterns: [
                            /verify.*account/i,
                            /confirm.*payment/i,
                            /update.*billing/i,
                            /unauthorized.*transaction/i,
                            /refund.*pending/i,
                            /suspended.*account/i,
                            /locked.*account/i
                        ],
                        weight: 25,
                        category: 'Financial Threats'
                    },
                    credentials: {
                        patterns: [
                            /password.*expire/i,
                            /reset.*password/i,
                            /verify.*identity/i,
                            /confirm.*email/i,
                            /security.*update/i,
                            /click.*here.*verify/i
                        ],
                        weight: 30,
                        category: 'Credential Harvesting'
                    },
                    grammar: {
                        patterns: [
                            /you're account/i,
                            /your an? /i,
                            /informations/i,
                            /departement/i,
                            /recieve/i,
                            /loose/i
                        ],
                        weight: 10,
                        category: 'Poor Grammar'
                    },
                    romance: {
                        patterns: [
                            /my dear/i,
                            /my love/i,
                            /fallen in love with you/i,
                            /send.*money.*help/i,
                            /stuck.*customs/i,
                            /inheritance/i,
                            /military.*deployment/i,
                            /oil rig/i,
                            /widow/i,
                            /orphan/i,
                            /god bless/i,
                            /western union/i,
                            /moneygram/i,
                            /gift cards/i,
                            /bitcoin.*send/i,
                            /emergency.*funds/i,
                            /hospital.*bills/i,
                            /can't video chat/i,
                            /camera.*broken/i
                        ],
                        weight: 35,
                        category: 'Romance Scam'
                    },
                    elder: {
                        patterns: [
                            /grandchild.*trouble/i,
                            /medicare.*update/i,
                            /social security.*suspend/i,
                            /irs.*warrant/i,
                            /arrest.*warrant/i,
                            /tech support.*virus/i,
                            /computer.*infected/i,
                            /refund.*overpayment/i,
                            /lottery.*winner/i,
                            /prize.*claim/i,
                            /charity.*donation/i,
                            /government.*grant/i
                        ],
                        weight: 40,
                        category: 'Elder Targeted Scam'
                    }
                },
                es: {
                    urgency: {
                        patterns: [
                            /acción.*urgente/i,
                            /atención.*inmediata/i,
                            /actú[ae].*ahora/i,
                            /expira.*pronto/i,
                            /tiempo.*limitado/i,
                            /último.*aviso/i,
                            /suspender.*dentro/i,
                            /24.*horas/i
                        ],
                        weight: 15,
                        category: 'Tácticas de Urgencia'
                    },
                    financial: {
                        patterns: [
                            /verific.*cuenta/i,
                            /confirm.*pago/i,
                            /actualiz.*facturación/i,
                            /transacción.*no.*autorizada/i,
                            /reembolso.*pendiente/i,
                            /cuenta.*suspendida/i,
                            /cuenta.*bloqueada/i
                        ],
                        weight: 25,
                        category: 'Amenazas Financieras'
                    },
                    credentials: {
                        patterns: [
                            /contraseña.*expir/i,
                            /restablecer.*contraseña/i,
                            /verific.*identidad/i,
                            /confirm.*correo/i,
                            /actualización.*seguridad/i,
                            /haz.*clic.*aquí.*verific/i
                        ],
                        weight: 30,
                        category: 'Robo de Credenciales'
                    },
                    grammar: {
                        patterns: [
                            /tu cuenta/i,
                            /informaciones/i,
                            /departamento/i,
                            /recivir/i,
                            /perdér/i
                        ],
                        weight: 10,
                        category: 'Gramática Deficiente'
                    },
                    romance: {
                        patterns: [
                            /mi amor/i,
                            /mi querido/i,
                            /enamorado de ti/i,
                            /enviar.*dinero.*ayuda/i,
                            /atrapado.*aduana/i,
                            /herencia/i,
                            /militar.*despliegue/i,
                            /plataforma petrolera/i,
                            /viuda/i,
                            /huérfano/i,
                            /dios te bendiga/i,
                            /western union/i,
                            /tarjetas de regalo/i,
                            /bitcoin.*enviar/i,
                            /emergencia.*fondos/i,
                            /facturas.*hospital/i,
                            /no puedo.*video/i,
                            /cámara.*rota/i
                        ],
                        weight: 35,
                        category: 'Estafa Romántica'
                    },
                    elder: {
                        patterns: [
                            /nieto.*problema/i,
                            /seguro médico.*actualizar/i,
                            /seguro social.*suspender/i,
                            /hacienda.*orden/i,
                            /orden.*arresto/i,
                            /soporte técnico.*virus/i,
                            /computadora.*infectada/i,
                            /reembolso.*pago excesivo/i,
                            /lotería.*ganador/i,
                            /premio.*reclamar/i,
                            /caridad.*donación/i,
                            /gobierno.*subvención/i
                        ],
                        weight: 40,
                        category: 'Estafa a Personas Mayores'
                    }
                }
            },
            
            /**
             * Analyze email for threats
             * @param {Object} emailData - Email data to analyze
             * @returns {Promise<Object>} Analysis results
             */
            async analyze(emailData) {
                const { sender, subject, body } = emailData;
                const fullText = `${sender} ${subject} ${body}`.toLowerCase();
                
                // Detect language
                const language = this.detectLanguage(fullText);
                const patterns = this.patterns[language] || this.patterns.en;
                
                let threatScore = 0;
                const indicators = [];
                const insights = [];
                
                // Pattern analysis
                for (const [type, config] of Object.entries(patterns)) {
                    for (const pattern of config.patterns) {
                        if (pattern.test(fullText)) {
                            threatScore += config.weight;
                            indicators.push({
                                type,
                                category: config.category,
                                severity: this.getSeverity(config.weight),
                                description: `Detected: ${config.category}`
                            });
                            break;
                        }
                    }
                }
                
                // URL analysis with real threat intelligence
                const urlAnalysis = await this.analyzeURLs(fullText);
                threatScore += urlAnalysis.score;
                indicators.push(...urlAnalysis.indicators);
                
                // Enhanced link safety analysis
                let linkSafetyWarning = null;
                try {
                    if (window.LinkSafetyModule) {
                        const detectedLinks = window.LinkSafetyModule.detectLinks(fullText);
                        if (detectedLinks.length > 0) {
                            const platform = window.electronAPI ? 'desktop' : 'mobile';
                            linkSafetyWarning = window.LinkSafetyModule.createLinkWarning(detectedLinks, platform);
                            
                            // Add to insights
                            if (linkSafetyWarning.overallRisk === 'high') {
                                threatScore += 15;
                                insights.push('High-risk links detected. Copy and paste links instead of clicking directly.');
                            } else if (linkSafetyWarning.overallRisk === 'medium') {
                                threatScore += 10;
                                insights.push('Suspicious links detected. Be cautious and verify before clicking.');
                            }
                        }
                    }
                } catch (linkError) {
                    console.error('Link safety module error:', linkError);
                }
                
                // Enhanced sender verification
                let senderVerification = null;
                try {
                    if (window.SenderVerificationModule && sender) {
                        senderVerification = window.SenderVerificationModule.generateVerificationReport(sender, emailData.senderName || '');
                        
                        // Add spoofing indicators to threat score
                        if (senderVerification.verificationResults.spoofingIndicators.length > 0) {
                            const highSeverity = senderVerification.verificationResults.spoofingIndicators.filter(s => s.severity === 'high').length;
                            threatScore += highSeverity * 20 + (senderVerification.verificationResults.spoofingIndicators.length - highSeverity) * 10;
                            
                            senderVerification.verificationResults.spoofingIndicators.forEach(spoofing => {
                                indicators.push({
                                    type: 'sender_spoofing',
                                    category: 'Sender Verification',
                                    severity: spoofing.severity,
                                    description: spoofing.message
                                });
                            });
                        }
                    }
                } catch (senderError) {
                    console.error('Sender verification module error:', senderError);
                }
                
                // Enhanced phone number verification
                let phoneWarning = null;
                try {
                    if (window.PhoneVerificationModule) {
                        const detectedPhones = window.PhoneVerificationModule.detectPhoneNumbers(fullText);
                        if (detectedPhones.length > 0) {
                            phoneWarning = window.PhoneVerificationModule.createPhoneWarning(detectedPhones, fullText);
                            
                            // Add to threat score based on phone risks
                            if (phoneWarning.overallRisk === 'critical') {
                                threatScore += 25;
                                insights.push('Critical warning: Dangerous phone numbers detected! Do NOT call these numbers.');
                            } else if (phoneWarning.overallRisk === 'high') {
                                threatScore += 20;
                                insights.push('High-risk phone numbers detected. Verify before calling.');
                            } else if (phoneWarning.overallRisk === 'medium') {
                                threatScore += 10;
                                insights.push('Suspicious phone numbers found. Be cautious.');
                            }
                            
                            // Add phone risks as indicators
                            phoneWarning.phoneAnalysis.forEach(analysis => {
                                analysis.risks.forEach(risk => {
                                    indicators.push({
                                        type: 'phone_risk',
                                        category: 'Phone Number Warning',
                                        severity: risk.severity === 'critical' ? 'danger' : risk.severity,
                                        description: risk.message
                                    });
                                });
                            });
                        }
                    }
                } catch (phoneError) {
                    console.error('Phone verification module error:', phoneError);
                }
                
                // Real threat intelligence analysis if available
                if (window.ThreatIntelligence) {
                    const realAnalysis = await window.ThreatIntelligence.analyzeEmailContent(emailData);
                    threatScore += realAnalysis.score;
                    
                    // Add real threats as indicators
                    realAnalysis.threats.forEach(threat => {
                        indicators.push({
                            type: 'real_threat',
                            category: threat.type,
                            severity: threat.severity || 'high',
                            description: threat.details || threat.type
                        });
                    });
                    
                    // Use real AI insights if available
                    if (realAnalysis.aiInsights && realAnalysis.aiInsights.length > 0) {
                        insights.push(...realAnalysis.aiInsights.map(insight => 
                            'insight.ai.' + insight.toLowerCase().replace(/[^a-z0-9]/g, '_')
                        ));
                    }
                }
                
                // Sender analysis
                const senderAnalysis = await this.analyzeSender(sender);
                threatScore += senderAnalysis.score;
                indicators.push(...senderAnalysis.indicators);
                
                // Real AI-powered analysis
                let aiInsights = [];
                if (window.AIAnalyzer) {
                    try {
                        const aiResult = await window.AIAnalyzer.analyze(emailData);
                        threatScore += aiResult.score * 0.5; // AI contributes up to 50 points
                        
                        // Add AI insights
                        aiInsights = aiResult.insights;
                        insights.push(...aiInsights);
                        
                        // Add risk factors as indicators
                        aiResult.riskFactors.forEach(risk => {
                            indicators.push({
                                type: 'ai_risk',
                                category: 'AI Risk Detection',
                                severity: aiResult.score > 60 ? 'high' : 'medium',
                                description: risk
                            });
                        });
                        
                        // Add recommendations to the analysis
                        if (!this._recommendations) {
                            this._recommendations = [];
                        }
                        this._recommendations.push(...aiResult.recommendations);
                    } catch (error) {
                        console.error('AI analysis failed:', error);
                    }
                } else {
                    // Fallback to simulated analysis
                    const aiAnalysis = await this.performAIAnalysis(emailData);
                    insights.push(...aiAnalysis.insights);
                }
                
                // Web search for real-time threats (simulated)
                const webThreats = await this.searchWebThreats(emailData);
                insights.push(...webThreats);
                // Add score for web threats
                if (webThreats.length > 0) {
                    threatScore += webThreats.length * 15;
                    indicators.push({
                        type: 'web_threats',
                        category: 'Known Threats',
                        severity: 'high',
                        description: `Found in ${webThreats.length} threat databases`
                    });
                }
                
                // Cap score at 100
                threatScore = Math.min(100, threatScore);
                
                return {
                    score: threatScore,
                    level: this.getThreatLevel(threatScore),
                    indicators,
                    insights,
                    language,
                    recommendations: this.getRecommendations(threatScore, language),
                    sender: sender || 'Unknown',
                    subject: subject || 'No Subject',
                    linkSafetyWarning: linkSafetyWarning,
                    senderVerification: senderVerification,
                    phoneWarning: phoneWarning
                };
            },
            
            /**
             * Detect email language
             * @param {string} text - Text to analyze
             * @returns {string} Language code
             */
            detectLanguage(text) {
                const spanishWords = ['para', 'con', 'por', 'que', 'usted', 'cuenta'];
                const englishWords = ['the', 'and', 'for', 'you', 'your', 'account'];
                
                let spanishCount = 0;
                let englishCount = 0;
                
                spanishWords.forEach(word => {
                    if (text.includes(word)) spanishCount++;
                });
                
                englishWords.forEach(word => {
                    if (text.includes(word)) englishCount++;
                });
                
                return spanishCount > englishCount ? 'es' : 'en';
            },
            
            /**
             * Analyze URLs in email
             * @param {string} text - Email text
             * @returns {Promise<Object>} URL analysis results
             */
            async analyzeURLs(text) {
                const urlPattern = /https?:\/\/[^\s]+/g;
                const urls = text.match(urlPattern) || [];
                let score = 0;
                const indicators = [];
                
                for (const url of urls) {
                    // Use real threat intelligence if available
                    if (window.ThreatIntelligence) {
                        try {
                            const urlCheck = await window.ThreatIntelligence.checkURL(url);
                            if (!urlCheck.safe || urlCheck.threats.length > 0) {
                                score += urlCheck.score || 30;
                                urlCheck.threats.forEach(threat => {
                                    indicators.push({
                                        type: 'url',
                                        category: 'Dangerous URL',
                                        severity: 'high',
                                        description: threat
                                    });
                                });
                            }
                        } catch (error) {
                            console.error('URL check failed:', error);
                        }
                    } else {
                        // Fallback to basic checks
                        if (/bit\.ly|tinyurl|goo\.gl|ow\.ly/i.test(url)) {
                            score += 20;
                            indicators.push({
                                type: 'url',
                                category: 'Suspicious URL',
                                severity: 'warning',
                                description: `URL shortener detected: ${url}`
                            });
                        }
                    }
                    
                    // Check for IP addresses
                    if (/\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/.test(url)) {
                        score += 30;
                        indicators.push({
                            type: 'url',
                            category: 'Suspicious URL',
                            severity: 'danger',
                            description: `Dangerous link detected: This uses numbers instead of a website name. Real companies use names like "amazon.com", not numbers like "192.168.1.100"`
                        });
                    }
                }
                
                return { score, indicators };
            },
            
            /**
             * Analyze sender reputation
             * @param {string} sender - Sender email
             * @returns {Promise<Object>} Sender analysis
             */
            async analyzeSender(sender) {
                if (!sender) return { score: 0, indicators: [] };
                
                let score = 0;
                const indicators = [];
                const domain = sender.split('@')[1];
                
                if (!domain) return { score: 0, indicators: [] };
                
                // Check for lookalike domains
                const legitDomains = ['gmail.com', 'outlook.com', 'yahoo.com', 'paypal.com'];
                for (const legit of legitDomains) {
                    const legitName = legit.split('.')[0];
                    if (domain.includes(legitName) && domain !== legit) {
                        score += 40;
                        indicators.push({
                            type: 'sender',
                            category: 'Spoofed Sender',
                            severity: 'danger',
                            description: `Lookalike domain: ${domain}`
                        });
                        break;
                    }
                }
                
                return { score, indicators };
            },
            
            /**
             * Perform AI analysis (simulated)
             * @param {Object} emailData - Email data
             * @returns {Promise<Object>} AI insights
             */
            async performAIAnalysis(emailData) {
                // AI processing (now instant)
                
                const insightKeys = [
                    'insight.ai.urgency',
                    'insight.ai.writing',
                    'insight.ai.pattern',
                    'insight.ai.sender'
                ];
                
                // Return 1-2 random insight keys
                const selectedKeys = insightKeys.slice(0, Math.floor(Math.random() * 2) + 1);
                
                return {
                    insights: selectedKeys
                };
            },
            
            /**
             * Search web for real-time threats (simulated)
             * @param {Object} emailData - Email data
             * @returns {Promise<Array>} Web threat insights
             */
            async searchWebThreats(emailData) {
                // Web threat search (now instant)
                
                const threatKeys = [
                    'insight.ai.similar',
                    'insight.ai.domain'
                ];
                
                // Return 0-2 threat keys based on random simulation
                const randomCount = Math.floor(Math.random() * 3);
                return threatKeys.slice(0, randomCount);
            },
            
            /**
             * Get severity level
             * @param {number} weight - Pattern weight
             * @returns {string} Severity level
             */
            getSeverity(weight) {
                if (weight >= 25) return 'danger';
                if (weight >= 15) return 'warning';
                return 'info';
            },
            
            /**
             * Get threat level
             * @param {number} score - Threat score
             * @returns {string} Threat level
             */
            getThreatLevel(score) {
                if (score >= SectConfig.thresholds.danger) return 'danger';
                if (score >= SectConfig.thresholds.warning) return 'warning';
                return 'safe';
            },
            
            /**
             * Get recommendations
             * @param {number} score - Threat score
             * @param {string} language - Language code
             * @returns {Array} Recommendations
             */
            getRecommendations(score, language) {
                const recommendations = {
                    en: {
                        safe: [
                            'Email appears legitimate',
                            'Still verify sender if unexpected',
                            'Be cautious with any links'
                        ],
                        warning: [
                            'Verify sender through another channel',
                            'Do not click suspicious links',
                            'Check with IT if work-related'
                        ],
                        danger: [
                            'DO NOT interact with this email',
                            'Mark as phishing immediately',
                            'Delete this email',
                            'Report to security team'
                        ]
                    },
                    es: {
                        safe: [
                            'El correo parece legítimo',
                            'Aún así verifica el remitente si es inesperado',
                            'Ten precaución con los enlaces'
                        ],
                        warning: [
                            'Verifica al remitente por otro canal',
                            'No hagas clic en enlaces sospechosos',
                            'Consulta con TI si es del trabajo'
                        ],
                        danger: [
                            'NO interactúes con este correo',
                            'Márcalo como phishing inmediatamente',
                            'Elimina este correo',
                            'Repórtalo al equipo de seguridad'
                        ]
                    }
                };
                
                const level = this.getThreatLevel(score);
                return recommendations[language][level];
            }
        };
        
        // =====================================================
        // VISUALIZATION MODULE
        // =====================================================
        
        /**
         * Data visualization module
         * @namespace Visualization
         */
        const Visualization = {
            charts: {},
            
            /**
             * Initialize all charts
             */
            async initialize() {
                await this.initializeDashboardCharts();
                this.startRealTimeFeed();
            },
            
            /**
             * Initialize dashboard charts
             */
            async initializeDashboardCharts() {
                // Threat trend chart
                const threatCtx = document.getElementById('threatChart');
                if (threatCtx) {
                    this.charts.threat = new Chart(threatCtx, {
                        type: 'line',
                        data: {
                            labels: this.generateTimeLabels(7),
                            datasets: [{
                                data: [45, 52, 38, 48, 35, 42, 28],
                                borderColor: '#ef4444',
                                backgroundColor: 'rgba(239, 68, 68, 0.1)',
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: SectConfig.chartDefaults
                    });
                }
                
                // Email analysis chart
                const emailCtx = document.getElementById('emailChart');
                if (emailCtx) {
                    this.charts.email = new Chart(emailCtx, {
                        type: 'bar',
                        data: {
                            labels: this.generateTimeLabels(7),
                            datasets: [{
                                data: [120, 135, 128, 142, 155, 148, 162],
                                backgroundColor: '#3b82f6'
                            }]
                        },
                        options: {
                            ...SectConfig.chartDefaults,
                            scales: {
                                x: { display: false },
                                y: { display: false }
                            }
                        }
                    });
                }
                
                // Accuracy chart
                const accuracyCtx = document.getElementById('accuracyChart');
                if (accuracyCtx) {
                    this.charts.accuracy = new Chart(accuracyCtx, {
                        type: 'doughnut',
                        data: {
                            datasets: [{
                                data: [99.7, 0.3],
                                backgroundColor: ['#10b981', 'rgba(255,255,255,0.1)'],
                                borderWidth: 0
                            }]
                        },
                        options: {
                            ...SectConfig.chartDefaults,
                            cutout: '80%'
                        }
                    });
                }
            },
            
            /**
             * Generate time labels
             * @param {number} count - Number of labels
             * @returns {Array} Labels
             */
            generateTimeLabels(count) {
                const labels = [];
                const now = new Date();
                
                for (let i = count - 1; i >= 0; i--) {
                    const date = new Date(now);
                    date.setDate(date.getDate() - i);
                    labels.push(date.toLocaleDateString('en', { weekday: 'short' }));
                }
                
                return labels;
            },
            
            /**
             * Update threat score visualization
             * @param {number} score - Threat score
             */
            updateThreatScore(score) {
                const progress = document.getElementById('threatProgress');
                const scoreEl = document.getElementById('threatScore');
                const badge = document.getElementById('threatBadge');
                
                if (!progress || !scoreEl || !badge) return;
                
                // Animate score
                let current = 0;
                const increment = score / 50;
                const timer = setInterval(() => {
                    current += increment;
                    if (current >= score) {
                        current = score;
                        clearInterval(timer);
                    }
                    scoreEl.textContent = Math.round(current);
                }, 20);
                
                // Update progress circle
                const circumference = 2 * Math.PI * 80;
                const offset = circumference - (score / 100) * circumference;
                progress.style.strokeDashoffset = offset;
                
                // Update color and badge
                let color, level;
                if (score >= SectConfig.thresholds.danger) {
                    color = '#ef4444';
                    level = 'danger';
                } else if (score >= SectConfig.thresholds.warning) {
                    color = '#f59e0b';
                    level = 'warning';
                } else {
                    color = '#10b981';
                    level = 'safe';
                }
                
                progress.style.stroke = color;
                badge.className = `threat-badge threat-${level}`;
                badge.innerHTML = `<span data-i18n="threat.${level}">${I18n.t(`threat.${level}`)}</span>`;
            },
            
            /**
             * Create comparison chart
             * @param {Object} data - Analysis data
             */
            createNetworkGraph(data) {
                const container = document.getElementById('networkGraph');
                if (!container) return;
                
                // Clear existing
                container.innerHTML = '';
                
                // Create canvas for comparison chart
                const canvas = document.createElement('canvas');
                canvas.id = 'comparisonChart';
                container.appendChild(canvas);
                
                // Calculate metrics from analysis data
                const analysisMetrics = {
                    urgency: 0,
                    grammar: 100,
                    links: 100,
                    reputation: 100
                };
                
                // Extract metrics from indicators
                if (data.indicators) {
                    data.indicators.forEach(indicator => {
                        switch(indicator.type) {
                            case 'urgency':
                                analysisMetrics.urgency = Math.min(100, analysisMetrics.urgency + 25);
                                break;
                            case 'grammar':
                                analysisMetrics.grammar = Math.max(0, analysisMetrics.grammar - 30);
                                break;
                            case 'url':
                                analysisMetrics.links = Math.max(0, analysisMetrics.links - 40);
                                break;
                            case 'sender':
                                analysisMetrics.reputation = Math.max(0, analysisMetrics.reputation - 50);
                                break;
                        }
                    });
                }
                
                const labels = I18n.currentLang === 'es' 
                    ? ['Urgencia', 'Gramática', 'Enlaces', 'Reputación']
                    : ['Urgency', 'Grammar', 'Links', 'Reputation'];
                
                // Create comparison chart
                const ctx = canvas.getContext('2d');
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: I18n.t('chart.currentEmail'),
                                data: [
                                    analysisMetrics.urgency,
                                    analysisMetrics.grammar,
                                    analysisMetrics.links,
                                    analysisMetrics.reputation
                                ],
                                backgroundColor: 'rgba(59, 130, 246, 0.8)',
                                borderColor: '#3b82f6',
                                borderWidth: 2
                            },
                            {
                                label: I18n.t('chart.phishingAverage'),
                                data: [85, 30, 20, 15],
                                backgroundColor: 'rgba(239, 68, 68, 0.8)',
                                borderColor: '#ef4444',
                                borderWidth: 2
                            },
                            {
                                label: I18n.t('chart.legitimateAverage'),
                                data: [10, 95, 90, 85],
                                backgroundColor: 'rgba(16, 185, 129, 0.8)',
                                borderColor: '#10b981',
                                borderWidth: 2
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    padding: 15,
                                    font: {
                                        size: 12
                                    },
                                    color: 'var(--text-primary)'
                                }
                            },
                            tooltip: {
                                backgroundColor: 'var(--bg-surface)',
                                titleColor: 'var(--text-primary)',
                                bodyColor: 'var(--text-secondary)',
                                borderColor: 'var(--border-color)',
                                borderWidth: 1,
                                cornerRadius: 8,
                                padding: 12
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    color: 'var(--text-secondary)',
                                    font: {
                                        size: 11
                                    },
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                },
                                grid: {
                                    color: 'var(--border-color)',
                                    borderDash: [3, 3]
                                }
                            },
                            x: {
                                ticks: {
                                    color: 'var(--text-secondary)',
                                    font: {
                                        size: 11
                                    }
                                },
                                grid: {
                                    display: false
                                }
                            }
                        },
                        animation: {
                            duration: 1500,
                            easing: 'easeInOutQuart'
                        }
                    }
                });
                
                // Add description
                const description = document.createElement('div');
                description.style.marginTop = '1rem';
                description.style.fontSize = '0.875rem';
                description.style.color = 'var(--text-secondary)';
                description.style.textAlign = 'center';
                description.innerHTML = I18n.currentLang === 'es' 
                    ? 'Comparación visual de métricas de seguridad entre el correo actual, promedios de phishing y correos legítimos.'
                    : 'Visual comparison of security metrics between current email, phishing averages, and legitimate emails.';
                container.appendChild(description);
            },
            
            /**
             * Start real-time threat feed
             */
            startRealTimeFeed() {
                // Use real threat feed if available
                if (window.RealThreatFeed) {
                    const feed = document.getElementById('threatFeed');
                    if (feed) {
                        feed.innerHTML = '<div class="feed-loading">Loading real-time threats...</div>';
                        
                        // Wait for RealThreatFeed to initialize
                        setTimeout(() => {
                            feed.innerHTML = window.RealThreatFeed.renderThreatFeed();
                        }, 1000);
                        
                        // Auto-refresh every 5 minutes
                        setInterval(() => {
                            window.RealThreatFeed.refreshFeeds();
                        }, 5 * 60 * 1000);
                    }
                    return;
                }
                
                // Fallback to fake feed if real feed not available
                for (let i = 0; i < 3; i++) {
                    this.addFeedItem();
                }
                
                setInterval(() => {
                    this.addFeedItem();
                }, 10000 + Math.random() * 20000);
            },
            
            /**
             * Add item to threat feed
             */
            addFeedItem() {
                const feed = document.getElementById('threatFeed');
                if (!feed) return;
                
                // Use real threat feed if available
                if (window.RealThreatFeed) {
                    feed.innerHTML = window.RealThreatFeed.renderThreatFeed();
                    return;
                }
                
                const types = ['critical', 'warning', 'info'];
                const sources = ['CISA', 'Security Week', 'CERT', 'FBI IC3', 'Threat Intel'];
                
                const threatData = {
                    en: [
                        {
                            message: 'New phishing campaign targeting financial institutions',
                            regions: 'North America, Europe',
                            recommendation: 'Update email filters and educate staff on latest tactics',
                            severity: 'critical'
                        },
                        {
                            message: 'Malware spreading through email attachments',
                            regions: 'Global',
                            recommendation: 'Scan all attachments and verify sender identity',
                            severity: 'warning'
                        },
                        {
                            message: 'Credential harvesting site detected',
                            regions: 'Asia Pacific, Europe',
                            recommendation: 'Enable 2FA and monitor for suspicious login attempts',
                            severity: 'critical'
                        },
                        {
                            message: 'Suspicious domain registrations spike',
                            regions: 'Worldwide',
                            recommendation: 'Review domain blocklists and update security policies',
                            severity: 'info'
                        }
                    ],
                    es: [
                        {
                            message: 'Nueva campaña de phishing dirigida a instituciones financieras',
                            regions: 'América del Norte, Europa',
                            recommendation: 'Actualizar filtros de correo y educar al personal sobre las últimas tácticas',
                            severity: 'critical'
                        },
                        {
                            message: 'Malware propagándose a través de archivos adjuntos',
                            regions: 'Global',
                            recommendation: 'Escanear todos los adjuntos y verificar la identidad del remitente',
                            severity: 'warning'
                        },
                        {
                            message: 'Sitio de robo de credenciales detectado',
                            regions: 'Asia Pacífico, Europa',
                            recommendation: 'Habilitar 2FA y monitorear intentos de inicio de sesión sospechosos',
                            severity: 'critical'
                        },
                        {
                            message: 'Pico de registros de dominios sospechosos',
                            regions: 'Mundial',
                            recommendation: 'Revisar listas de bloqueo de dominios y actualizar políticas de seguridad',
                            severity: 'info'
                        }
                    ]
                };
                
                const dataList = threatData[I18n.currentLang] || threatData.en;
                const data = dataList[Math.floor(Math.random() * dataList.length)];
                const source = sources[Math.floor(Math.random() * sources.length)];
                
                const item = document.createElement('div');
                item.className = `feed-item ${data.severity}`;
                item.innerHTML = `
                    <div class="feed-item-header">
                        <span class="feed-time">${new Date().toLocaleTimeString()}</span>
                        <span class="feed-source">${source}</span>
                    </div>
                    <div class="feed-item-content">
                        <p class="feed-message">${data.message}</p>
                    </div>
                    <div class="feed-item-details" style="display: none;">
                        <p><strong>${I18n.t('feed.affectedRegions')}:</strong> ${data.regions}</p>
                        <p><strong>${I18n.t('feed.recommendation')}:</strong> ${data.recommendation}</p>
                        <a href="#" class="feed-learn-more" onclick="event.preventDefault(); alert('This would link to detailed threat intelligence')">${I18n.t('feed.learnMore')}</a>
                    </div>
                `;
                
                item.addEventListener('click', function() {
                    const details = this.querySelector('.feed-item-details');
                    details.style.display = details.style.display === 'none' ? 'block' : 'none';
                });
                
                feed.insertBefore(item, feed.firstChild);
                
                // Remove old items
                while (feed.children.length > 10) {
                    feed.removeChild(feed.lastChild);
                }
            }
        };
        
        // =====================================================
        // FILE HANDLER
        // =====================================================
        
        /**
         * File upload and processing module
         * @namespace FileHandler
         */
        const FileHandler = {
            /**
             * Initialize file handlers
             */
            initialize() {
                const zone = document.getElementById('fileUpload');
                const input = document.getElementById('fileInput');
                
                if (!zone || !input) return;
                
                // Click to upload
                zone.addEventListener('click', () => input.click());
                
                // Drag and drop
                zone.addEventListener('dragover', e => {
                    e.preventDefault();
                    zone.classList.add('drag-over');
                });
                
                zone.addEventListener('dragleave', () => {
                    zone.classList.remove('drag-over');
                });
                
                zone.addEventListener('drop', e => {
                    e.preventDefault();
                    zone.classList.remove('drag-over');
                    
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        this.processFile(files[0]);
                    }
                });
                
                // File selection
                input.addEventListener('change', e => {
                    const files = e.target.files;
                    if (files.length > 0) {
                        this.processFile(files[0]);
                    }
                });
            },
            
            /**
             * Process uploaded file
             * @param {File} file - File to process
             */
            async processFile(file) {
                UI.showLoading(I18n.t('loading.analyzing'));
                
                try {
                    if (file.type.startsWith('image/')) {
                        await this.processImage(file);
                    } else {
                        await this.processText(file);
                    }
                } catch (error) {
                    console.error('File processing error:', error);
                    UI.hideLoading();
                    alert('Error processing file');
                }
            },
            
            /**
             * Process image with OCR
             * @param {File} file - Image file
             */
            async processImage(file) {
                UI.updateLoadingText(I18n.t('loading.ocr'));
                
                const result = await Tesseract.recognize(
                    file,
                    I18n.currentLang === 'es' ? 'spa' : 'eng',
                    {
                        logger: m => {
                            if (m.status === 'recognizing text') {
                                const progress = Math.round(m.progress * 100);
                                UI.updateLoadingProgress(`${progress}%`);
                            }
                        }
                    }
                );
                
                document.getElementById('body').value = result.data.text;
                UI.hideLoading();
            },
            
            /**
             * Process text file
             * @param {File} file - Text file
             */
            async processText(file) {
                const text = await file.text();
                document.getElementById('body').value = text;
                UI.hideLoading();
            }
        };
        
        // =====================================================
        // UI CONTROLLER
        // =====================================================
        
        /**
         * UI management module
         * @namespace UI
         */
        const UI = {
            /**
             * Show loading overlay
             * @param {string} text - Loading text
             */
            showLoading(text) {
                const overlay = document.getElementById('loadingOverlay');
                const textEl = document.getElementById('loadingText');
                
                if (overlay && textEl) {
                    textEl.textContent = text;
                    overlay.classList.add('active');
                }
            },
            
            /**
             * Update loading text
             * @param {string} text - New text
             */
            updateLoadingText(text) {
                const textEl = document.getElementById('loadingText');
                if (textEl) textEl.textContent = text;
            },
            
            /**
             * Update loading progress
             * @param {string} progress - Progress text
             */
            updateLoadingProgress(progress) {
                const progressEl = document.getElementById('loadingProgress');
                if (progressEl) progressEl.textContent = progress;
            },
            
            /**
             * Hide loading overlay
             */
            hideLoading() {
                const overlay = document.getElementById('loadingOverlay');
                if (overlay) overlay.classList.remove('active');
            },
            
            /**
             * Display analysis results
             * @param {Object} results - Analysis results
             */
            displayResults(results) {
                // Show results section
                const section = document.getElementById('results');
                if (section) section.style.display = 'block';
                
                // Update threat score
                Visualization.updateThreatScore(results.score);
                
                // Display insights
                this.displayInsights(results);
                
                // Create visualizations
                Visualization.createNetworkGraph(results);
                
                // Create timeline chart
                this.createTimelineChart(results);
                
                // Create detailed analysis
                this.createDetailedAnalysis(results);
                
                // Update stats
                this.updateStats();
                
                // Scroll to results
                setTimeout(() => {
                    section.scrollIntoView({ behavior: 'smooth' });
                }, 100);
            },
            
            /**
             * Display analysis insights
             * @param {Object} results - Analysis results
             */
            displayInsights(results) {
                const grid = document.getElementById('insightsGrid');
                if (!grid) return;
                
                grid.innerHTML = '';
                
                // Add indicators
                results.indicators.forEach(indicator => {
                    const card = document.createElement('div');
                    card.className = 'insight-card';
                    
                    const iconClass = indicator.severity === 'danger' ? 'bad' : 'good';
                    const icon = indicator.severity === 'danger' ? '⚠' : '✓';
                    
                    card.innerHTML = `
                        <div class="insight-header">
                            <div class="insight-icon ${iconClass}">${icon}</div>
                            <h3>${indicator.category}</h3>
                        </div>
                        <p>${indicator.description}</p>
                    `;
                    
                    grid.appendChild(card);
                });
                
                // Add AI insights
                if (results.insights && results.insights.length > 0) {
                    const aiCard = document.createElement('div');
                    aiCard.className = 'insight-card';
                    aiCard.innerHTML = `
                        <div class="insight-header">
                            <div class="insight-icon" style="background: var(--viz-2); color: white;">🤖</div>
                            <h3>${I18n.t('insight.ai')}</h3>
                        </div>
                        <ul>
                            ${results.insights.map(i => {
                                // Handle both translation keys and actual text
                                if (i.startsWith('insight.')) {
                                    return `<li>${I18n.t(i)}</li>`;
                                } else {
                                    // Translate dynamic content
                                    const translated = (window.RealTranslationService && I18n.currentLang !== 'en') ? 
                                        window.RealTranslationService.translate(i, I18n.currentLang) : i;
                                    return `<li>${translated}</li>`;
                                }
                            }).join('')}
                        </ul>
                    `;
                    grid.appendChild(aiCard);
                }
                
                // Add link safety warning if present
                if (results.linkSafetyWarning && window.LinkSafetyModule) {
                    const linkWarningHTML = window.LinkSafetyModule.formatLinkWarningHTML(results.linkSafetyWarning);
                    const linkCard = document.createElement('div');
                    linkCard.innerHTML = linkWarningHTML;
                    grid.appendChild(linkCard.firstElementChild);
                }
                
                // Add sender verification report if present
                if (results.senderVerification && window.SenderVerificationModule) {
                    const verificationHTML = window.SenderVerificationModule.formatVerificationHTML(results.senderVerification);
                    const verificationCard = document.createElement('div');
                    verificationCard.innerHTML = verificationHTML;
                    grid.appendChild(verificationCard.firstElementChild);
                }
                
                // Add phone warning if present
                if (results.phoneWarning && window.PhoneVerificationModule) {
                    const phoneWarningHTML = window.PhoneVerificationModule.formatPhoneWarningHTML(results.phoneWarning);
                    const phoneCard = document.createElement('div');
                    phoneCard.innerHTML = phoneWarningHTML;
                    grid.appendChild(phoneCard.firstElementChild);
                }
                
                // Add behavioral analysis if present
                if (results.behaviorAnalysis && window.BehavioralAnalysisEngine) {
                    const behaviorExplanation = window.BehavioralAnalysisEngine.generateBehavioralExplanation(results.behaviorAnalysis);
                    const behaviorCard = document.createElement('div');
                    behaviorCard.className = 'insight-card';
                    behaviorCard.innerHTML = `
                        <div class="insight-header">
                            <div class="insight-icon" style="background: var(--viz-3); color: white;">🧠</div>
                            <h3>Behavioral Analysis</h3>
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <div class="behavior-level behavior-${behaviorExplanation.level}" style="padding: 0.5rem; border-radius: 6px; margin-bottom: 0.5rem;">
                                <strong>Risk Level: ${behaviorExplanation.level.toUpperCase()}</strong>
                            </div>
                            <p style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 1rem;">${behaviorExplanation.explanation}</p>
                            <p style="color: var(--text-primary); font-size: 0.875rem; font-weight: 500;">${behaviorExplanation.advice}</p>
                        </div>
                        ${results.behaviorAnalysis.redFlags.length > 0 ? `
                            <div style="margin-top: 1rem;">
                                <h4 style="color: var(--status-danger); margin-bottom: 0.5rem;">⚠️ Red Flags:</h4>
                                <ul style="margin: 0; padding-left: 1.5rem; color: var(--text-secondary); font-size: 0.875rem;">
                                    ${results.behaviorAnalysis.redFlags.map(flag => `<li>${flag}</li>`).join('')}
                                </ul>
                            </div>
                        ` : ''}
                    `;
                    grid.appendChild(behaviorCard);
                }
                
                // Add adaptive learning feedback section
                if (window.AdaptiveLearningSystem) {
                    window.AdaptiveLearningSystem.addFeedbackToResults(results, grid);
                }
            },
            
            /**
             * Update dashboard statistics
             */
            updateStats() {
                // Animate threat count
                const threatCount = document.getElementById('threatCount');
                if (threatCount) {
                    const current = parseInt(threatCount.textContent) || 0;
                    this.animateNumber(threatCount, current, current + Math.floor(Math.random() * 5) + 1);
                }
                
                // Animate email count
                const emailCount = document.getElementById('emailCount');
                if (emailCount) {
                    const current = parseInt(emailCount.textContent) || 0;
                    this.animateNumber(emailCount, current, current + 1);
                }
            },
            
            /**
             * Animate number change
             * @param {HTMLElement} element - Element to update
             * @param {number} start - Start value
             * @param {number} end - End value
             */
            animateNumber(element, start, end) {
                const duration = 1000;
                const startTime = performance.now();
                
                const update = (currentTime) => {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    const current = Math.floor(start + (end - start) * progress);
                    
                    element.textContent = current;
                    
                    if (progress < 1) {
                        requestAnimationFrame(update);
                    }
                };
                
                requestAnimationFrame(update);
            },
            
            /**
             * Create timeline chart
             * @param {Object} results - Analysis results
             */
            createTimelineChart(results) {
                const canvas = document.getElementById('timelineChart');
                if (!canvas) return;
                
                // Generate timeline data
                const now = new Date();
                const timeLabels = [];
                const threatLevels = [];
                
                // Create hourly data points for the last 24 hours
                for (let i = 23; i >= 0; i--) {
                    const time = new Date(now.getTime() - i * 60 * 60 * 1000);
                    timeLabels.push(time.toLocaleTimeString('en', { hour: '2-digit', minute: '2-digit' }));
                    
                    // Simulate threat levels with current analysis spike
                    if (i === 0) {
                        threatLevels.push(results.score);
                    } else {
                        threatLevels.push(Math.floor(Math.random() * 30) + 10);
                    }
                }
                
                // Create timeline chart
                const ctx = canvas.getContext('2d');
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: timeLabels,
                        datasets: [{
                            label: I18n.currentLang === 'es' ? 'Nivel de Amenaza' : 'Threat Level',
                            data: threatLevels,
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointBackgroundColor: function(context) {
                                const value = context.parsed.y;
                                if (value >= 60) return '#ef4444';
                                if (value >= 30) return '#f59e0b';
                                return '#10b981';
                            },
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'var(--bg-surface)',
                                titleColor: 'var(--text-primary)',
                                bodyColor: 'var(--text-secondary)',
                                borderColor: 'var(--border-color)',
                                borderWidth: 1,
                                cornerRadius: 8,
                                padding: 12
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    color: 'var(--text-secondary)',
                                    font: { size: 11 },
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                },
                                grid: {
                                    color: 'var(--border-color)',
                                    borderDash: [3, 3]
                                }
                            },
                            x: {
                                ticks: {
                                    color: 'var(--text-secondary)',
                                    font: { size: 11 },
                                    maxRotation: 45,
                                    minRotation: 45
                                },
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            },
            
            /**
             * Create detailed analysis view
             * @param {Object} results - Analysis results
             */
            createDetailedAnalysis(results) {
                const container = document.getElementById('detailedAnalysis');
                if (!container) return;
                
                const detailedHTML = `
                    <div class="insights-grid">
                        <div class="insight-card">
                            <div class="insight-header">
                                <div class="insight-icon" style="background: var(--viz-1); color: white;">📧</div>
                                <h3>${I18n.currentLang === 'es' ? 'Datos del Correo' : 'Email Data'}</h3>
                            </div>
                            <div style="font-size: 0.875rem; color: var(--text-secondary);">
                                <p><strong>${I18n.currentLang === 'es' ? 'Remitente' : 'Sender'}:</strong> ${results.sender || 'N/A'}</p>
                                <p><strong>${I18n.currentLang === 'es' ? 'Idioma Detectado' : 'Detected Language'}:</strong> ${results.language === 'es' ? 'Español' : 'English'}</p>
                                <p><strong>${I18n.currentLang === 'es' ? 'Puntuación de Amenaza' : 'Threat Score'}:</strong> ${results.score}/100</p>
                                <p><strong>${I18n.currentLang === 'es' ? 'Nivel de Riesgo' : 'Risk Level'}:</strong> ${I18n.t('threat.' + results.level)}</p>
                            </div>
                        </div>
                        
                        <div class="insight-card">
                            <div class="insight-header">
                                <div class="insight-icon" style="background: var(--viz-3); color: white;">🔍</div>
                                <h3>${I18n.currentLang === 'es' ? 'Indicadores Detectados' : 'Detected Indicators'}</h3>
                            </div>
                            <ul style="font-size: 0.875rem; color: var(--text-secondary);">
                                ${results.indicators.map(ind => {
                                    // Translate category, description, and severity
                                    const category = window.TranslationService ? 
                                        window.TranslationService.translate(ind.category, I18n.currentLang) : ind.category;
                                    const description = window.TranslationService ? 
                                        window.TranslationService.translate(ind.description, I18n.currentLang) : ind.description;
                                    const severity = window.TranslationService ? 
                                        window.TranslationService.translate(ind.severity, I18n.currentLang) : ind.severity;
                                    
                                    return `
                                        <li style="margin-bottom: 0.5rem;">
                                            <strong>${category}:</strong> ${description}
                                            <span style="color: var(--status-${ind.severity});">(${severity})</span>
                                        </li>
                                    `;
                                }).join('')}
                            </ul>
                        </div>
                        
                        <div class="insight-card">
                            <div class="insight-header">
                                <div class="insight-icon" style="background: var(--viz-4); color: white;">💡</div>
                                <h3>${I18n.currentLang === 'es' ? 'Recomendaciones' : 'Recommendations'}</h3>
                            </div>
                            <ul style="font-size: 0.875rem; color: var(--text-secondary);">
                                ${results.recommendations.map(rec => `<li style="margin-bottom: 0.5rem;">${rec}</li>`).join('')}
                            </ul>
                        </div>
                        
                        <div class="insight-card" style="grid-column: 1 / -1;">
                            <div class="insight-header">
                                <div class="insight-icon" style="background: var(--viz-5); color: white;">📊</div>
                                <h3>${I18n.currentLang === 'es' ? 'Análisis Técnico' : 'Technical Analysis'}</h3>
                            </div>
                            <div style="font-size: 0.875rem; color: var(--text-secondary);">
                                <p>${I18n.currentLang === 'es' 
                                    ? 'Este correo ha sido analizado utilizando múltiples capas de detección incluyendo análisis de patrones, verificación de remitente, inspección de URLs y procesamiento de lenguaje natural. El sistema ha evaluado ' + results.indicators.length + ' indicadores diferentes para determinar el nivel de amenaza.'
                                    : 'This email has been analyzed using multiple detection layers including pattern analysis, sender verification, URL inspection, and natural language processing. The system evaluated ' + results.indicators.length + ' different indicators to determine the threat level.'
                                }</p>
                                <div style="margin-top: 1rem; padding: 1rem; background: var(--bg-primary); border-radius: 8px; font-family: var(--font-mono); font-size: 0.75rem;">
                                    <div>Analysis timestamp: ${new Date().toISOString()}</div>
                                    <div>Engine version: SECT v3.0.0</div>
                                    <div>Detection patterns: ${Object.keys(results.indicators.reduce((acc, ind) => { acc[ind.type] = true; return acc; }, {})).join(', ')}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                container.innerHTML = detailedHTML;
            }
        };
        
        // =====================================================
        // GLOBAL FUNCTIONS
        // =====================================================
        
        /**
         * Set application language
         * @param {string} lang - Language code
         */
        window.setLanguage = function(lang) {
            I18n.currentLang = lang;
            I18n.updateUI();
            
            // Update real translation service
            if (window.RealTranslationService) {
                window.RealTranslationService.setLanguage(lang);
                window.RealTranslationService.translatePage();
            }
            
            // Update knowledge base language
            if (window.RealKnowledgeBase) {
                window.RealKnowledgeBase.setLanguage(lang);
                const kbContainer = document.getElementById('knowledgeBaseContainer');
                if (kbContainer && kbContainer.innerHTML.includes('knowledge-base')) {
                    kbContainer.innerHTML = window.RealKnowledgeBase.renderKnowledgeBase();
                }
            }
            
            // Update education intro
            const educationIntro = document.querySelector('.education-intro');
            if (educationIntro) {
                educationIntro.querySelector('h2').textContent = lang === 'es' ? 'Centro de Educación en Ciberseguridad' : 'Cybersecurity Education Center';
                educationIntro.querySelector('p:first-of-type').textContent = lang === 'es' 
                    ? 'Bienvenido al Centro de Educación en Ciberseguridad de SECT. Esta sección está diseñada para ayudarle a entender las amenazas de seguridad en línea y aprender cómo protegerse. Encuentre guías prácticas, artículos detallados y las últimas noticias de seguridad, todo en un lenguaje simple y accesible.'
                    : 'Welcome to the SECT Cybersecurity Education Center. This section is designed to help you understand online security threats and learn how to protect yourself. Find practical guides, detailed articles, and the latest security news, all in simple, accessible language.';
                educationIntro.querySelector('p:last-of-type').textContent = lang === 'es'
                    ? '📚 Base de Conocimientos • 📰 Noticias de Seguridad en Tiempo Real • 🎓 Recursos Educativos'
                    : '📚 Knowledge Base • 📰 Real-Time Security News • 🎓 Educational Resources';
            }
            
            // Update score explanation content
            const scoreExplanationContent = document.getElementById('scoreExplanationContent');
            if (scoreExplanationContent && window.educationalContent) {
                const content = window.educationalContent[lang] || window.educationalContent.en;
                const safeP = scoreExplanationContent.querySelector('[data-score-type="safe"]');
                const warningP = scoreExplanationContent.querySelector('[data-score-type="warning"]');
                const dangerP = scoreExplanationContent.querySelector('[data-score-type="danger"]');
                
                if (safeP) safeP.textContent = content.scoreExplanation.safe;
                if (warningP) warningP.textContent = content.scoreExplanation.warning;
                if (dangerP) dangerP.textContent = content.scoreExplanation.danger;
            }
            
            // Update legitimate/phishing points
            const legitPoints = document.getElementById('legitimatePoints');
            const phishingPoints = document.getElementById('phishingPoints');
            if (legitPoints && phishingPoints && window.educationalContent) {
                const content = window.educationalContent[lang] || window.educationalContent.en;
                legitPoints.innerHTML = content.legitimate.map(p => `<li>${p}</li>`).join('');
                phishingPoints.innerHTML = content.phishing.map(p => `<li>${p}</li>`).join('');
            }
            
            // Update threat feed
            if (window.RealThreatFeed) {
                const threatFeedContainer = document.getElementById('threatFeed');
                if (threatFeedContainer) {
                    threatFeedContainer.innerHTML = window.RealThreatFeed.renderThreatFeed();
                }
            }
            
            // Update all dynamic content with data-translate-dynamic attribute
            document.querySelectorAll('[data-translate-dynamic]').forEach(element => {
                const key = element.getAttribute('data-translate-dynamic');
                if (window.RealTranslationService) {
                    element.textContent = window.RealTranslationService.translate(key);
                }
            });
            
            // Update buttons
            document.querySelectorAll('.lang-option').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.lang === lang);
            });
            
            // Animate slider
            const slider = document.getElementById('langSlider');
            const activeBtn = document.querySelector(`.lang-option[data-lang="${lang}"]`);
            
            if (slider && activeBtn) {
                slider.style.width = activeBtn.offsetWidth + 'px';
                slider.style.transform = `translateX(${activeBtn.offsetLeft - 4}px)`;
            }
            
            // Save preference
            localStorage.setItem('sectLang', lang);
        };
        
        /**
         * Toggle theme
         */
        window.toggleTheme = function() {
            const body = document.body;
            const isDark = body.classList.toggle('dark-theme');
            
            // Update icon
            const icon = document.getElementById('themeIcon');
            if (icon) {
                if (isDark) {
                    icon.innerHTML = '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>';
                } else {
                    icon.innerHTML = `
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    `;
                }
            }
            
            // Save preference
            localStorage.setItem('sectTheme', isDark ? 'dark' : 'light');
            
            // Update Chart.js colors for dark mode
            if (window.Chart) {
                Chart.defaults.color = getComputedStyle(document.body).getPropertyValue('--text-secondary');
                Chart.defaults.borderColor = getComputedStyle(document.body).getPropertyValue('--border-color');
            }
        };
        
        /**
         * Analyze email - WORKING VERSION
         */
        window.analyzeEmail = async function() {
            console.log('analyzeEmail function called');
            
            try {
                const sender = document.getElementById('sender').value;
                const subject = document.getElementById('subject').value;
                const body = document.getElementById('body').value;
                
                console.log('Input values:', { sender, subject, body });
                
                if (!body) {
                    alert('Please provide email content to analyze');
                    return;
                }
                
                console.log('Starting analysis...');
                UI.showLoading('Analyzing email...');
                
                // Give UI time to show loading
                await new Promise(resolve => setTimeout(resolve, 100));
                
                // Basic threat analysis
                const results = await ThreatEngine.analyze({ sender, subject, body });
                console.log('Basic analysis results:', results);
                
                // Ensure results has required properties
                if (!results.insights) results.insights = [];
                if (!results.recommendations) results.recommendations = [];
                if (!results.indicators) results.indicators = [];
                
                // Local threat analysis (privacy-first)
                try {
                    if (window.LocalThreatAnalysis) {
                        UI.updateLoadingText('Performing local threat analysis...');
                        const localAnalysis = window.LocalThreatAnalysis.analyzeEmail({ sender, subject, body });
                        
                        if (localAnalysis) {
                            results.localAnalysis = localAnalysis;
                            
                            // Add local insights
                            if (localAnalysis.rules_matched.length > 0) {
                                results.insights.push(`🔍 Local Analysis: ${localAnalysis.rules_matched.length} threat patterns detected`);
                                localAnalysis.rules_matched.forEach(rule => {
                                    results.insights.push(`• ${rule.description} (${rule.tags.join(', ')})`);
                                });
                            }
                            
                            // Update threat score with local analysis
                            results.score = Math.max(results.score, localAnalysis.score);
                            
                            // Add privacy notice
                            results.insights.push('✅ Analysis performed locally - your data never left your device');
                        }
                    }
                } catch (e) {
                    console.log('Local analysis error:', e.message);
                }
                
                // Try REAL API analysis
                try {
                    if (window.RealAPIIntegration && sender) {
                        UI.updateLoadingText('🔍 Checking email against breach databases...');
                        const realEmailAnalysis = await window.RealAPIIntegration.analyzeEmail(sender, body);
                        
                        if (realEmailAnalysis) {
                            results.realEmailAnalysis = realEmailAnalysis;
                            
                            // Add breach warnings
                            if (realEmailAnalysis.breaches && realEmailAnalysis.breaches.found) {
                                results.insights.push(`🚨 REAL BREACH DATA: Email found in ${realEmailAnalysis.breaches.breaches.length} confirmed data breaches`);
                                realEmailAnalysis.breaches.breaches.slice(0, 2).forEach(breach => {
                                    results.insights.push(`• Breach: ${breach.name} (${breach.breachDate}) - ${breach.dataClasses.join(', ')}`);
                                });
                            }
                            
                            // Add validation warnings
                            if (realEmailAnalysis.validation && !realEmailAnalysis.validation.isValid) {
                                results.insights.push('⚠️ Email format is invalid');
                            }
                            
                            // Add domain warnings
                            if (realEmailAnalysis.domainReputation && !realEmailAnalysis.domainReputation.safe) {
                                results.insights.push('🚫 Domain flagged by security databases');
                            }
                            
                            // Add recommendations
                            if (realEmailAnalysis.recommendations) {
                                results.recommendations.push(...realEmailAnalysis.recommendations.slice(0, 2));
                            }
                            
                            // Update threat score with real data
                            results.score = Math.min(100, results.score + realEmailAnalysis.riskScore);
                        }
                    } else if (window.EnhancedThreatIntelligence && sender) {
                        UI.updateLoadingText('Checking email reputation...');
                        const emailAnalysis = await window.EnhancedThreatIntelligence.analyzeEmailSender(sender, body);
                        if (emailAnalysis) {
                            results.enhancedEmailAnalysis = emailAnalysis;
                            if (emailAnalysis.warnings) {
                                results.insights.push(...emailAnalysis.warnings);
                            }
                        }
                    }
                } catch (e) {
                    console.log('API email analysis error:', e.message);
                    results.insights.push('⚠️ Some verification services unavailable - analysis may be incomplete');
                }
                
                try {
                    if (window.EnhancedThreatIntelligence) {
                        UI.updateLoadingText('Analyzing phone numbers...');
                        const phoneNumbers = body.match(/\d{3}[-.\\s]?\d{3}[-.\\s]?\d{4}/g) || [];
                        
                        for (const phoneNumber of phoneNumbers.slice(0, 2)) { // Limit to 2 numbers to avoid excessive API calls
                            const phoneAnalysis = await window.EnhancedThreatIntelligence.analyzePhoneNumber(phoneNumber, body);
                            if (phoneAnalysis && phoneAnalysis.warnings) {
                                results.insights.push(...phoneAnalysis.warnings);
                                if (phoneAnalysis.recommendations) {
                                    results.recommendations.push(...phoneAnalysis.recommendations.slice(0, 2));
                                }
                            }
                        }
                        
                        if (phoneNumbers.length > 0) {
                            results.insights.push(`Found ${phoneNumbers.length} phone number(s) - verify independently before calling`);
                        }
                    } else if (window.PhoneVerificationModule) {
                        UI.updateLoadingText('Analyzing phone numbers...');
                        const phoneNumbers = window.PhoneVerificationModule.detectPhoneNumbers(body);
                        if (phoneNumbers.length > 0) {
                            results.insights.push(`Found ${phoneNumbers.length} phone number(s) - verify before calling`);
                        }
                    }
                } catch (e) {
                    console.log('Phone verification not available:', e.message);
                }
                
                try {
                    if (window.BehavioralAnalysisEngine) {
                        UI.updateLoadingText('Analyzing behavioral patterns...');
                        const behaviorAnalysis = await window.BehavioralAnalysisEngine.analyzeEmailBehavior({ sender, subject, body });
                        if (behaviorAnalysis && behaviorAnalysis.behaviorInsights) {
                            results.behaviorAnalysis = behaviorAnalysis;
                            results.insights.push(...behaviorAnalysis.behaviorInsights.slice(0, 2));
                        }
                    }
                } catch (e) {
                    console.log('Behavioral analysis not available:', e.message);
                }
                
                // Advanced AI Engine Analysis (Sophisticated privacy-preserving intelligent analysis)
                try {
                    if (window.AdvancedAI) {
                        UI.updateLoadingText('Running advanced AI analysis...');
                        const aiAnalysis = window.AdvancedAI.analyze({ sender, subject, body });
                        
                        if (aiAnalysis) {
                            results.aiAnalysis = aiAnalysis;
                            
                            // Override threat score with AI analysis if higher
                            if (aiAnalysis.threatScore > results.score) {
                                results.score = aiAnalysis.threatScore;
                            }
                            
                            // Add AI scam classification
                            if (aiAnalysis.scamType && aiAnalysis.scamType !== 'Suspicious Message') {
                                results.insights.unshift(`🤖 AI Classification: ${aiAnalysis.scamType}`);
                            }
                            
                            // Add AI insights
                            if (aiAnalysis.insights && aiAnalysis.insights.length > 0) {
                                results.insights.push('🧠 Advanced AI Analysis:');
                                aiAnalysis.insights.slice(0, 4).forEach(insight => {
                                    results.insights.push(`• ${insight}`);
                                });
                            }
                            
                            // Add AI recommendation
                            if (aiAnalysis.recommendation) {
                                results.recommendations.unshift(aiAnalysis.recommendation);
                            }
                            
                            // Add detailed AI scores
                            if (aiAnalysis.confidence) {
                                results.insights.push(`🎯 AI Confidence: ${Math.round(aiAnalysis.confidence * 100)}% | Severity: ${aiAnalysis.severity.toUpperCase()}`);
                            }
                            
                            // Add manipulation analysis
                            if (aiAnalysis.manipulation_score > 0.3) {
                                results.insights.push(`⚠️ Psychological manipulation detected (${Math.round(aiAnalysis.manipulation_score * 100)}% intensity)`);
                            }
                            
                            console.log('AI Analysis completed:', aiAnalysis);
                        }
                    }
                } catch (e) {
                    console.log('Mini AI analysis error:', e.message);
                }
                
                // Finalize results
                results.level = ThreatEngine.getThreatLevel(results.score);
                results.sender = sender || 'Unknown';
                results.subject = subject || 'No Subject';
                
                console.log('Final results:', results);
                
                UI.hideLoading();
                UI.displayResults(results);
                
            } catch (error) {
                console.error('Critical analysis error:', error);
                UI.hideLoading();
                alert('Analysis failed: ' + error.message);
            }
        };
        
        /**
         * Switch tab
         * @param {string} tab - Tab name
         */
        window.switchTab = function(tab) {
            // Update buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const tabContent = document.getElementById(`${tab}Tab`);
            if (tabContent) {
                tabContent.classList.add('active');
                
                // Load knowledge base when education tab is opened
                if (tab === 'education' && window.CybersecurityKnowledgeBase) {
                    const container = document.getElementById('knowledgeBaseContainer');
                    if (container && !container.innerHTML.trim()) {
                        container.innerHTML = window.CybersecurityKnowledgeBase.renderKnowledgeBase();
                    }
                }
            }
        };
        
        /**
         * Show modal (placeholder for privacy, terms, about)
         * @param {string} type - Modal type
         */
        window.showModal = function(type) {
            const content = {
                privacy: `SECT PRIVACY POLICY

Your Privacy is Our Priority

SECT is designed with your privacy at its core:

• NO DATA COLLECTION: We do not collect, store, or transmit any of your personal data or email content
• 100% LOCAL PROCESSING: All email analysis happens entirely on your device
• YOU'RE IN CONTROL: Your data never leaves your device - you have complete control
• NO TRACKING: We don't track your usage, analyze your behavior, or create profiles
• NO THIRD PARTIES: Your information is never shared because we never have access to it

SECT operates on a simple principle: Your security shouldn't come at the cost of your privacy.`,
                
                terms: `SECT TERMS OF SERVICE

By using SECT, you agree to these terms:

1. SERVICE PROVIDED "AS IS"
SECT is provided as a free service to help identify potential cyber threats. While we strive for accuracy, no security system is 100% perfect. SECT does not guarantee complete protection from all threats.

2. NO LIABILITY
The creators of SECT are not liable for any damages resulting from the use or inability to use this service. Users remain responsible for their own cybersecurity decisions.

3. FREE FOR EVERYONE
SECT is and will remain free. No individual or organization may commercialize SECT or offer it as a paid service. This includes:
• Charging for access to SECT
• Bundling SECT with paid services
• Creating derivative works for commercial purposes

4. REDISTRIBUTION
You may share and redistribute SECT freely, but all distributions must:
• Remain free of charge
• Include this license
• Maintain attribution to the original creators

5. USER RESPONSIBILITY
You are responsible for:
• Verifying suspicious emails through multiple methods
• Making informed decisions about email safety
• Keeping your system and browser updated

Remember: SECT is a tool to help you, not a replacement for common sense and caution.`,
                
                about: `ABOUT SECT

SECT: Security Intelligence for Everyone

SECT represents a paradigm shift in cybersecurity - transforming everyday users from passive victims into active participants in their own digital safety.

WHAT MAKES SECT UNIQUE:

• FIRST OF ITS KIND: SECT is the world's first truly accessible email security platform designed specifically for non-technical users

• REVOLUTIONARY CONCEPT: Unlike traditional cybersecurity tools that either oversimplify or overwhelm, SECT strikes the perfect balance

• FREE FOREVER: While enterprise solutions cost thousands, SECT provides professional-grade protection at no cost

• EMPOWERMENT THROUGH UNDERSTANDING: SECT doesn't just block threats - it explains them in plain language, helping users learn and grow

OUR MISSION:
Bridge the cybersecurity gap between large organizations with dedicated IT teams and everyday people who deserve the same level of protection.

SECT proves that powerful security doesn't require:
• Technical expertise
• Expensive subscriptions  
• Complex configurations
• Sacrificing privacy

Every person deserves to feel safe online. SECT makes that possible.

Created with ❤️ for the everyday person.`,
                
                learn: `CYBERSECURITY TERMS EXPLAINED SIMPLY

🔐 PHISHING
When scammers pretend to be a company you trust (like your bank) to steal your password or personal info. Like fishing, but they're trying to catch YOU!

🔗 URL / LINK
The web address you see in your browser (like www.google.com). Scammers create fake ones that LOOK real but aren't.

📧 SPOOFING
Making an email look like it's from someone else. Like putting on a disguise - the email might say "From: PayPal" but it's really from a scammer.

🌐 DOMAIN
The main part of a website name. For PayPal, it's "paypal.com". Scammers use similar names like "paypaI.com" (with a capital i instead of l).

⚠️ MALWARE
Bad software that harms your computer. Like a virus that makes you sick, but for your device.

🎣 SOCIAL ENGINEERING
Tricking people using psychology instead of technology. Like when someone calls pretending to be from Microsoft to gain your trust.

🔑 TWO-FACTOR AUTHENTICATION (2FA)
Using two different ways to prove it is you - like a password AND a code sent to your phone. Like having two locks on your door!

🛡️ ENCRYPTION
Scrambling information so only the right person can read it. Like writing in a secret code only you and your friend know.

💾 ATTACHMENT
A file sent with an email (like a photo or document). Be careful - bad attachments can infect your computer!

🚨 RANSOMWARE
Malware that locks your files until you pay money. Like a kidnapper, but for your photos and documents.

🌐 IP ADDRESS
Your computer phone number on the internet. Every device has one. Scammers sometimes use these instead of normal website names.

🔐 HTTPS vs HTTP
HTTPS = Secure website (look for the padlock 🔒)
HTTP = Not secure (no padlock)
Always check for HTTPS when entering passwords!

📱 SMISHING
Phishing but through text messages (SMS + phishing = smishing)

🎭 IDENTITY THEFT
When someone steals your personal info to pretend to be you, usually to steal money or commit crimes in your name.

💳 SKIMMING
Stealing credit card info when you swipe or insert your card. Can happen at ATMs or gas stations with hidden devices.

Remember: When in doubt, do not click! It is always better to be safe than sorry. 🛡️`
            };
            
            alert(content[type] || 'Information not available');
        };
        
        // =====================================================
        // INITIALIZATION
        // =====================================================
        
        /**
         * Initialize application
         */
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('SECT v3.0.0 - Initializing...');
            
            // Load saved preferences
            const savedTheme = localStorage.getItem('sectTheme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
                const icon = document.getElementById('themeIcon');
                if (icon) {
                    icon.innerHTML = '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>';
                }
            }
            
            // Initialize language
            I18n.updateUI();
            setLanguage(I18n.currentLang);
            
            // Initialize modules
            await Visualization.initialize();
            FileHandler.initialize();
            
            // Initialize Enhanced Threat Intelligence
            if (window.EnhancedThreatIntelligence) {
                window.EnhancedThreatIntelligence.initialize();
            }
            
            // Initialize Knowledge Base
            if (window.CybersecurityKnowledgeBase) {
                window.CybersecurityKnowledgeBase.initialize();
            }
            
            // Initialize Adaptive Learning System
            if (window.AdaptiveLearningSystem) {
                window.AdaptiveLearningSystem.initialize();
            }
            
            // Initialize Local Threat Analysis
            if (window.LocalThreatAnalysis) {
                window.LocalThreatAnalysis.initialize();
            }
            
            // Configure Chart.js for better dark mode support
            if (window.Chart) {
                Chart.defaults.color = getComputedStyle(document.body).getPropertyValue('--text-secondary');
                Chart.defaults.borderColor = getComputedStyle(document.body).getPropertyValue('--border-color');
            }
            
            // Populate educational content
            window.educationalContent = {
                en: {
                    legitimate: [
                        'Verified sender domain matches organization (e.g., @paypal.com for PayPal)',
                        'Professional tone without urgency - legitimate companies give you time to respond',
                        'Specific details about your account or recent transactions',
                        'No suspicious links or attachments - hover to check URLs before clicking',
                        'Proper grammar and spelling - major companies have editorial standards',
                        'Contact information provided - legitimate companies want you to reach them',
                        'Sent to your specific email address, not "undisclosed recipients"'
                    ],
                    phishing: [
                        'Creates false urgency or threats ("Act now or your account will be closed!")',
                        'Generic greetings like "Dear Customer" or "Dear User"',
                        'Requests sensitive information via email (passwords, SSN, credit cards)',
                        'Contains spelling/grammar errors - often from non-native speakers',
                        'Uses URL shorteners or suspicious links (bit.ly, tinyurl)',
                        'Sender address doesn\'t match company name (e.g., paypal@gmail.com)',
                        'Attachments you weren\'t expecting, especially .zip or .exe files',
                        'Too good to be true offers ("You\'ve won $1,000,000!")',
                        'Asks you to verify information the company should already have'
                    ],
                    scoreExplanation: {
                        safe: 'Threat Score 0-30: This email appears safe. The content and sender show no significant signs of phishing or malicious intent. However, always verify unexpected emails.',
                        warning: 'Threat Score 31-60: Exercise caution. This email shows some suspicious characteristics. Verify the sender through another channel before taking any action.',
                        danger: 'Threat Score 61-100: High risk detected! This email exhibits multiple phishing indicators. Do not click links, download attachments, or provide any information.'
                    }
                },
                es: {
                    legitimate: [
                        'Dominio del remitente verificado coincide con la organización (ej: @paypal.com para PayPal)',
                        'Tono profesional sin urgencia - las empresas legítimas te dan tiempo para responder',
                        'Detalles específicos sobre tu cuenta o transacciones recientes',
                        'Sin enlaces o adjuntos sospechosos - pasa el cursor para verificar URLs antes de hacer clic',
                        'Gramática y ortografía correctas - las grandes empresas tienen estándares editoriales',
                        'Información de contacto proporcionada - las empresas legítimas quieren que las contactes',
                        'Enviado a tu dirección de correo específica, no a "destinatarios no revelados"'
                    ],
                    phishing: [
                        'Crea falsa urgencia o amenazas ("¡Actúa ahora o tu cuenta será cerrada!")',
                        'Saludos genéricos como "Estimado Cliente" o "Estimado Usuario"',
                        'Solicita información sensible por correo (contraseñas, SSN, tarjetas de crédito)',
                        'Contiene errores de ortografía/gramática - a menudo de hablantes no nativos',
                        'Usa acortadores de URL o enlaces sospechosos (bit.ly, tinyurl)',
                        'La dirección del remitente no coincide con el nombre de la empresa (ej: paypal@gmail.com)',
                        'Adjuntos que no esperabas, especialmente archivos .zip o .exe',
                        'Ofertas demasiado buenas para ser verdad ("¡Has ganado $1,000,000!")',
                        'Te pide verificar información que la empresa ya debería tener'
                    ],
                    scoreExplanation: {
                        safe: 'Puntuación de Amenaza 0-30: Este correo parece seguro. El contenido y el remitente no muestran signos significativos de phishing o intención maliciosa. Sin embargo, siempre verifica los correos inesperados.',
                        warning: 'Puntuación de Amenaza 31-60: Ejerce precaución. Este correo muestra algunas características sospechosas. Verifica al remitente por otro canal antes de tomar cualquier acción.',
                        danger: 'Puntuación de Amenaza 61-100: ¡Alto riesgo detectado! Este correo exhibe múltiples indicadores de phishing. No hagas clic en enlaces, descargues adjuntos o proporciones información.'
                    }
                }
            };
            
            const legitPoints = document.getElementById('legitimatePoints');
            if (legitPoints) {
                const points = window.educationalContent[I18n.currentLang]?.legitimate || window.educationalContent.en.legitimate;
                legitPoints.innerHTML = points.map(p => `<li>${p}</li>`).join('');
            }
            
            const phishingPoints = document.getElementById('phishingPoints');
            if (phishingPoints) {
                const points = window.educationalContent[I18n.currentLang]?.phishing || window.educationalContent.en.phishing;
                phishingPoints.innerHTML = points.map(p => `<li>${p}</li>`).join('');
            }
            
            // Add score explanation section if not exists
            const educationTab = document.getElementById('educationTab');
            if (educationTab && !document.getElementById('scoreExplanation')) {
                // Add introduction to education tab
                const introHTML = `
                    <div class="education-intro" style="margin-bottom: 2rem; padding: 2rem; background: var(--bg-secondary); border-radius: 12px;">
                        <h2 style="color: var(--text-primary); margin-bottom: 1rem;">${I18n.currentLang === 'es' ? 'Centro de Educación en Ciberseguridad' : 'Cybersecurity Education Center'}</h2>
                        <p style="color: var(--text-secondary); line-height: 1.6; margin-bottom: 1rem;">
                            ${I18n.currentLang === 'es' 
                                ? 'Bienvenido al Centro de Educación en Ciberseguridad de SECT. Esta sección está diseñada para ayudarle a entender las amenazas de seguridad en línea y aprender cómo protegerse. Encuentre guías prácticas, artículos detallados y las últimas noticias de seguridad, todo en un lenguaje simple y accesible.'
                                : 'Welcome to the SECT Cybersecurity Education Center. This section is designed to help you understand online security threats and learn how to protect yourself. Find practical guides, detailed articles, and the latest security news, all in simple, accessible language.'
                            }
                        </p>
                        <p style="color: var(--text-secondary); font-size: 0.9rem;">
                            ${I18n.currentLang === 'es'
                                ? '📚 Base de Conocimientos • 📰 Noticias de Seguridad en Tiempo Real • 🎓 Recursos Educativos'
                                : '📚 Knowledge Base • 📰 Real-Time Security News • 🎓 Educational Resources'
                            }
                        </p>
                    </div>
                `;
                educationTab.insertAdjacentHTML('afterbegin', introHTML);
                const scoreExplanationHTML = `
                    <div class="insights-grid" style="margin-top: 2rem;">
                        <div class="insight-card" style="grid-column: 1 / -1;">
                            <div class="insight-header">
                                <div class="insight-icon" style="background: var(--viz-1); color: white;">📈</div>
                                <h3 data-i18n="education.scoreExplanation">Understanding Threat Scores</h3>
                            </div>
                            <div id="scoreExplanationContent">
                                <div style="margin-bottom: 1rem;">
                                    <h4 style="color: var(--status-safe); margin-bottom: 0.5rem;">🔒 ${I18n.t('threat.safe')} (0-30)</h4>
                                    <p style="color: var(--text-secondary); font-size: 0.875rem;" data-score-type="safe">${window.educationalContent[I18n.currentLang]?.scoreExplanation.safe || window.educationalContent.en.scoreExplanation.safe}</p>
                                </div>
                                <div style="margin-bottom: 1rem;">
                                    <h4 style="color: var(--status-warning); margin-bottom: 0.5rem;">⚠️ ${I18n.t('threat.warning')} (31-60)</h4>
                                    <p style="color: var(--text-secondary); font-size: 0.875rem;" data-score-type="warning">${window.educationalContent[I18n.currentLang]?.scoreExplanation.warning || window.educationalContent.en.scoreExplanation.warning}</p>
                                </div>
                                <div>
                                    <h4 style="color: var(--status-danger); margin-bottom: 0.5rem;">🚫 ${I18n.t('threat.danger')} (61-100)</h4>
                                    <p style="color: var(--text-secondary); font-size: 0.875rem;" data-score-type="danger">${window.educationalContent[I18n.currentLang]?.scoreExplanation.danger || window.educationalContent.en.scoreExplanation.danger}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                educationTab.insertAdjacentHTML('beforeend', scoreExplanationHTML);
                
                // Use existing knowledge base container
                const existingKbContainer = document.getElementById('knowledgeBaseContainer');
                if (existingKbContainer && window.RealKnowledgeBase) {
                    window.RealKnowledgeBase.initialize();
                    existingKbContainer.innerHTML = window.RealKnowledgeBase.renderKnowledgeBase();
                } else if (existingKbContainer) {
                    existingKbContainer.innerHTML = '<div class="insight-card" style="grid-column: 1 / -1;"><div class="insight-header"><div class="insight-icon" style="background: var(--viz-1); color: white;">📚</div><h3>Knowledge Base</h3></div><p>Loading knowledge base...</p></div>';
                }
                
                // Note: Threat feed is already shown in the overview section, no need to duplicate it here
            }
            
            // Auto-update copyright year
            const copyrightYearElement = document.getElementById('copyrightYear');
            if (copyrightYearElement) {
                copyrightYearElement.textContent = new Date().getFullYear();
            }
            
            console.log('SECT initialized successfully');
        });
    </script>
</body>
</html>